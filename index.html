<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è²©å£²å®Ÿç¸¾é›†è¨ˆãƒ„ãƒ¼ãƒ«</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', 'Hiragino Sans', 'Meiryo', sans-serif;
      background: #f5f7fa;
      color: #333;
      line-height: 1.6;
      padding: 20px;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 30px;
      font-size: 1.8rem;
    }

    .card {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 25px;
      margin-bottom: 20px;
    }

    .card-title {
      font-size: 1.1rem;
      color: #34495e;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #3498db;
    }

    .upload-area {
      border: 2px dashed #bdc3c7;
      border-radius: 8px;
      padding: 40px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      background: #fafafa;
    }

    .upload-area:hover,
    .upload-area.dragover {
      border-color: #3498db;
      background: #ebf5fb;
    }

    .upload-area p {
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-area .icon {
      font-size: 3rem;
      color: #bdc3c7;
      margin-bottom: 10px;
    }

    #fileInput {
      display: none;
    }

    .file-info {
      margin-top: 15px;
      padding: 10px 15px;
      background: #e8f6f3;
      border-radius: 5px;
      color: #1e8449;
      display: none;
    }

    .file-info.show {
      display: block;
    }

    .btn {
      display: inline-block;
      padding: 12px 30px;
      font-size: 1rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .btn-primary {
      background: #3498db;
      color: #fff;
    }

    .btn-primary:hover {
      background: #2980b9;
    }

    .btn-primary:disabled {
      background: #bdc3c7;
      cursor: not-allowed;
    }

    .btn-success {
      background: #27ae60;
      color: #fff;
    }

    .btn-success:hover {
      background: #1e8449;
    }

    .btn-group {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .action-area {
      text-align: center;
      margin: 20px 0;
    }

    .results {
      display: none;
    }

    .results.show {
      display: block;
    }

    .stats {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    .stat-item {
      flex: 1;
      min-width: 150px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 5px;
      text-align: center;
    }

    .stat-item .number {
      font-size: 2rem;
      font-weight: bold;
      color: #2c3e50;
    }

    .stat-item .label {
      font-size: 0.9rem;
      color: #7f8c8d;
    }

    .stat-item.success .number {
      color: #27ae60;
    }

    .stat-item.warning .number {
      color: #e67e22;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      font-size: 0.9rem;
    }

    th, td {
      padding: 10px 12px;
      text-align: left;
      border-bottom: 1px solid #ecf0f1;
    }

    th {
      background: #34495e;
      color: #fff;
      font-weight: 500;
    }

    tr:hover {
      background: #f8f9fa;
    }

    .table-container {
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #ecf0f1;
      border-radius: 5px;
    }

    .no-data {
      text-align: center;
      padding: 30px;
      color: #95a5a6;
    }

    .download-area {
      margin-top: 20px;
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 1.4rem;
      }

      .stats {
        flex-direction: column;
      }

      .btn-group {
        flex-direction: column;
      }

      .btn {
        width: 100%;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>è²©å£²å®Ÿç¸¾é›†è¨ˆãƒ„ãƒ¼ãƒ«</h1>

    <!-- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢ -->
    <div class="card">
      <div class="card-title">è²©å£²å®Ÿç¸¾CSVã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</div>
      <div class="upload-area" id="uploadArea">
        <div class="icon">ğŸ“</div>
        <p>ã“ã“ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—</p>
        <p>ã¾ãŸã¯ ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ</p>
      </div>
      <input type="file" id="fileInput" accept=".csv">
      <div class="file-info" id="fileInfo"></div>
    </div>

    <!-- é›†è¨ˆå®Ÿè¡Œãƒœã‚¿ãƒ³ -->
    <div class="action-area">
      <button class="btn btn-primary" id="executeBtn" disabled>é›†è¨ˆå®Ÿè¡Œ</button>
    </div>

    <!-- çµæœã‚¨ãƒªã‚¢ -->
    <div class="results" id="results">
      <div class="card">
        <div class="card-title">é›†è¨ˆçµæœ</div>
        <div class="stats">
          <div class="stat-item">
            <div class="number" id="totalCount">0</div>
            <div class="label">å‡¦ç†ä»¶æ•°</div>
          </div>
          <div class="stat-item success">
            <div class="number" id="matchCount">0</div>
            <div class="label">ãƒãƒƒãƒ</div>
          </div>
          <div class="stat-item warning">
            <div class="number" id="unmatchCount">0</div>
            <div class="label">æœªå‡¦ç†</div>
          </div>
        </div>
        <div class="download-area">
          <div class="btn-group">
            <button class="btn btn-success" id="downloadBtn">CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
          </div>
        </div>
      </div>

      <!-- æœªå‡¦ç†ãƒ‡ãƒ¼ã‚¿ä¸€è¦§ -->
      <div class="card">
        <div class="card-title">æœªå‡¦ç†ãƒ‡ãƒ¼ã‚¿ä¸€è¦§</div>
        <div class="table-container">
          <table id="unmatchTable">
            <thead>
              <tr>
                <th>å•†å“ç®¡ç†ç•ªå·</th>
                <th>å•†å“å</th>
                <th>ã™ã¹ã¦ã®æƒ…å ±</th>
                <th>æ•°é‡</th>
                <th>ç†ç”±</th>
              </tr>
            </thead>
            <tbody id="unmatchBody">
            </tbody>
          </table>
          <div class="no-data" id="noUnmatchData">æœªå‡¦ç†ãƒ‡ãƒ¼ã‚¿ã¯ã‚ã‚Šã¾ã›ã‚“</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ==========================================
    // ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ (274è¡Œ)
    // ==========================================
    const masterData = [
      // y001: ã‚¨ãƒªã‚¶ãƒ™ã‚¹ã‚«ãƒ©ãƒ¼ (è¡Œ1-5)
      { row: 1, productId: "y001", sku: "ã‚¿ã‚¤ãƒ—:é€šå¸¸å“\nã‚«ãƒ©ãƒ¼:ã‚¤ã‚¨ãƒ­ãƒ¼" },
      { row: 2, productId: "y001", sku: "ã‚¿ã‚¤ãƒ—:é€šå¸¸å“\nã‚«ãƒ©ãƒ¼:ã‚°ãƒªãƒ¼ãƒ³" },
      { row: 3, productId: "y001", sku: "ã‚¿ã‚¤ãƒ—:é€šå¸¸å“\nã‚«ãƒ©ãƒ¼:ã‚°ãƒ¬ãƒ¼" },
      { row: 4, productId: "y001", sku: "ã‚¿ã‚¤ãƒ—:é€šå¸¸å“\nã‚«ãƒ©ãƒ¼:ãƒ”ãƒ³ã‚¯" },
      { row: 5, productId: "y001", sku: "ã‚¿ã‚¤ãƒ—:é€šå¸¸å“\nã‚«ãƒ©ãƒ¼:ãƒ–ãƒ«ãƒ¼" },

      // y002: ãƒšãƒƒãƒˆã‚·ãƒ¼ãƒ„ (è¡Œ6-54)
      { row: 6, productId: "y002", sku: "ã‚°ãƒ¬ãƒ¼ XS" },
      { row: 7, productId: "y002", sku: "ã‚°ãƒ¬ãƒ¼ S" },
      { row: 8, productId: "y002", sku: "ã‚°ãƒ¬ãƒ¼ M" },
      { row: 9, productId: "y002", sku: "ã‚°ãƒ¬ãƒ¼ L" },
      { row: 10, productId: "y002", sku: "ã‚°ãƒ¬ãƒ¼ XL" },
      { row: 11, productId: "y002", sku: "ã‚°ãƒ¬ãƒ¼ å¤§" },
      { row: 12, productId: "y002", sku: "ã‚°ãƒ¬ãƒ¼ ç‰¹å¤§" },
      { row: 13, productId: "y002", sku: "ãƒ™ãƒ¼ã‚¸ãƒ¥ XS" },
      { row: 14, productId: "y002", sku: "ãƒ™ãƒ¼ã‚¸ãƒ¥ S" },
      { row: 15, productId: "y002", sku: "ãƒ™ãƒ¼ã‚¸ãƒ¥ M" },
      { row: 16, productId: "y002", sku: "ãƒ™ãƒ¼ã‚¸ãƒ¥ L" },
      { row: 17, productId: "y002", sku: "ãƒ™ãƒ¼ã‚¸ãƒ¥ XL" },
      { row: 18, productId: "y002", sku: "ãƒ™ãƒ¼ã‚¸ãƒ¥ å¤§" },
      { row: 19, productId: "y002", sku: "ãƒ™ãƒ¼ã‚¸ãƒ¥ ç‰¹å¤§" },
      { row: 20, productId: "y002", sku: "ã‚·ãƒ«ãƒãƒ¼ãƒ‘ãƒ¼ãƒ—ãƒ« XS" },
      { row: 21, productId: "y002", sku: "ã‚·ãƒ«ãƒãƒ¼ãƒ‘ãƒ¼ãƒ—ãƒ« S" },
      { row: 22, productId: "y002", sku: "ã‚·ãƒ«ãƒãƒ¼ãƒ‘ãƒ¼ãƒ—ãƒ« M" },
      { row: 23, productId: "y002", sku: "ã‚·ãƒ«ãƒãƒ¼ãƒ‘ãƒ¼ãƒ—ãƒ« L" },
      { row: 24, productId: "y002", sku: "ã‚·ãƒ«ãƒãƒ¼ãƒ‘ãƒ¼ãƒ—ãƒ« XL" },
      { row: 25, productId: "y002", sku: "ã‚·ãƒ«ãƒãƒ¼ãƒ‘ãƒ¼ãƒ—ãƒ« å¤§" },
      { row: 26, productId: "y002", sku: "ã‚·ãƒ«ãƒãƒ¼ãƒ‘ãƒ¼ãƒ—ãƒ« ç‰¹å¤§" },
      { row: 27, productId: "y002", sku: "éª¨æŸ„ã‚°ãƒ¬ãƒ¼ XS" },
      { row: 28, productId: "y002", sku: "éª¨æŸ„ã‚°ãƒ¬ãƒ¼ S" },
      { row: 29, productId: "y002", sku: "éª¨æŸ„ã‚°ãƒ¬ãƒ¼ M" },
      { row: 30, productId: "y002", sku: "éª¨æŸ„ã‚°ãƒ¬ãƒ¼ L" },
      { row: 31, productId: "y002", sku: "éª¨æŸ„ã‚°ãƒ¬ãƒ¼ XL" },
      { row: 32, productId: "y002", sku: "éª¨æŸ„ã‚°ãƒ¬ãƒ¼ å¤§" },
      { row: 33, productId: "y002", sku: "éª¨æŸ„ã‚°ãƒ¬ãƒ¼ ç‰¹å¤§" },
      { row: 34, productId: "y002", sku: "éª¨æŸ„ãƒ›ãƒ¯ã‚¤ãƒˆ XS" },
      { row: 35, productId: "y002", sku: "éª¨æŸ„ãƒ›ãƒ¯ã‚¤ãƒˆ S" },
      { row: 36, productId: "y002", sku: "éª¨æŸ„ãƒ›ãƒ¯ã‚¤ãƒˆ M" },
      { row: 37, productId: "y002", sku: "éª¨æŸ„ãƒ›ãƒ¯ã‚¤ãƒˆ L" },
      { row: 38, productId: "y002", sku: "éª¨æŸ„ãƒ›ãƒ¯ã‚¤ãƒˆ XL" },
      { row: 39, productId: "y002", sku: "éª¨æŸ„ãƒ›ãƒ¯ã‚¤ãƒˆ å¤§" },
      { row: 40, productId: "y002", sku: "éª¨æŸ„ãƒ›ãƒ¯ã‚¤ãƒˆ ç‰¹å¤§" },
      { row: 41, productId: "y002", sku: "ãƒ›ãƒ¯ã‚¤ãƒˆ XS" },
      { row: 42, productId: "y002", sku: "ãƒ›ãƒ¯ã‚¤ãƒˆ S" },
      { row: 43, productId: "y002", sku: "ãƒ›ãƒ¯ã‚¤ãƒˆ M" },
      { row: 44, productId: "y002", sku: "ãƒ›ãƒ¯ã‚¤ãƒˆ L" },
      { row: 45, productId: "y002", sku: "ãƒ›ãƒ¯ã‚¤ãƒˆ XL" },
      { row: 46, productId: "y002", sku: "ãƒ›ãƒ¯ã‚¤ãƒˆ å¤§" },
      { row: 47, productId: "y002", sku: "ãƒ›ãƒ¯ã‚¤ãƒˆ ç‰¹å¤§" },
      { row: 48, productId: "y002", sku: "çŠ¬æŸ„ãƒ–ãƒ©ã‚¦ãƒ³ XS" },
      { row: 49, productId: "y002", sku: "çŠ¬æŸ„ãƒ–ãƒ©ã‚¦ãƒ³ S" },
      { row: 50, productId: "y002", sku: "çŠ¬æŸ„ãƒ–ãƒ©ã‚¦ãƒ³ M" },
      { row: 51, productId: "y002", sku: "çŠ¬æŸ„ãƒ–ãƒ©ã‚¦ãƒ³ L" },
      { row: 52, productId: "y002", sku: "çŠ¬æŸ„ãƒ–ãƒ©ã‚¦ãƒ³ XL" },
      { row: 53, productId: "y002", sku: "çŠ¬æŸ„ãƒ–ãƒ©ã‚¦ãƒ³ å¤§" },
      { row: 54, productId: "y002", sku: "çŠ¬æŸ„ãƒ–ãƒ©ã‚¦ãƒ³ ç‰¹å¤§" },

      // y003, y004, y005 ç©ºè¡Œ (è¡Œ55-57)
      { row: 55, productId: "", sku: "" },
      { row: 56, productId: "", sku: "" },
      { row: 57, productId: "", sku: "" },

      // y003 (è¡Œ58)
      { row: 58, productId: "y003", sku: "" },

      // ç©ºè¡Œ (è¡Œ59)
      { row: 59, productId: "", sku: "" },

      // y004 (è¡Œ60)
      { row: 60, productId: "y004", sku: "" },

      // ç©ºè¡Œ (è¡Œ61)
      { row: 61, productId: "", sku: "" },

      // y005 (è¡Œ62-76)
      { row: 62, productId: "y005", sku: "" },
      { row: 63, productId: "y005", sku: "" },
      { row: 64, productId: "y005", sku: "" },
      { row: 65, productId: "y005", sku: "" },
      { row: 66, productId: "y005", sku: "" },
      { row: 67, productId: "y005", sku: "" },
      { row: 68, productId: "y005", sku: "" },
      { row: 69, productId: "y005", sku: "" },
      { row: 70, productId: "y005", sku: "" },
      { row: 71, productId: "y005", sku: "" },
      { row: 72, productId: "y005", sku: "" },
      { row: 73, productId: "y005", sku: "" },
      { row: 74, productId: "y005", sku: "" },
      { row: 75, productId: "y005", sku: "" },
      { row: 76, productId: "y005", sku: "" },

      // y006: é˜²æ°´ãƒãƒ¼ãƒ (è¡Œ77-90)
      { row: 77, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#1 ãƒ–ãƒ©ãƒƒã‚¯" },
      { row: 78, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#2 ãƒãƒ£ã‚³ãƒ¼ãƒ«ã‚°ãƒ¬ãƒ¼" },
      { row: 79, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#3ã‚°ãƒ¬ãƒ¼" },
      { row: 80, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#4ãƒã‚¤ãƒ“ãƒ¼" },
      { row: 81, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#5 ãƒ–ãƒ«ãƒ¼" },
      { row: 82, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#6 ã‚°ãƒ¬ã‚¤ãƒƒã‚·ãƒ¥ãƒ–ãƒ«ãƒ¼" },
      { row: 83, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#7 ãƒ™ãƒ“ãƒ¼ãƒ–ãƒ«ãƒ¼" },
      { row: 84, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#8 ã‚°ãƒ¬ã‚¤ãƒƒã‚·ãƒ¥ã‚°ãƒªãƒ¼ãƒ³" },
      { row: 85, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#9ã‚·ãƒ¼ã‚°ãƒªãƒ¼ãƒ³" },
      { row: 86, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#10ã‚¤ã‚¨ãƒ­ãƒ¼" },
      { row: 87, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#11 ã‚¯ãƒ­ãƒ ã‚ªãƒ¬ãƒ³ã‚¸" },
      { row: 88, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#12ãƒ‘ãƒ¼ãƒ—ãƒ«" },
      { row: 89, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#13 ãƒ©ãƒ™ãƒ³ãƒ€ãƒ¼" },
      { row: 90, productId: "y006", sku: "ã‚«ãƒ©ãƒ¼:#14ãƒ”ãƒ³ã‚¯" },

      // y007 (è¡Œ91-101)
      { row: 91, productId: "y007", sku: "" },
      { row: 92, productId: "y007", sku: "" },
      { row: 93, productId: "y007", sku: "" },
      { row: 94, productId: "y007", sku: "" },
      { row: 95, productId: "y007", sku: "" },
      { row: 96, productId: "y007", sku: "" },
      { row: 97, productId: "y007", sku: "" },
      { row: 98, productId: "y007", sku: "" },
      { row: 99, productId: "y007", sku: "" },
      { row: 100, productId: "y007", sku: "" },
      { row: 101, productId: "y007", sku: "" },

      // y008waki_pad (è¡Œ102)
      { row: 102, productId: "y008waki_pad", sku: "10" },

      // ç©ºè¡Œ (è¡Œ103-104)
      { row: 103, productId: "", sku: "" },
      { row: 104, productId: "", sku: "" },

      // y009: ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã‚±ãƒ¼ã‚¹ (è¡Œ105-118)
      { row: 105, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ã‚·ãƒ³ãƒ—ãƒ«\nã‚«ãƒ©ãƒ¼:#1 ãƒ›ãƒ¯ã‚¤ãƒˆ" },
      { row: 106, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ã‚·ãƒ³ãƒ—ãƒ«\nã‚«ãƒ©ãƒ¼:#2 ãƒ–ãƒ©ãƒƒã‚¯" },
      { row: 107, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ã‚·ãƒ³ãƒ—ãƒ«\nã‚«ãƒ©ãƒ¼:#3 ãƒ¬ãƒƒãƒ‰" },
      { row: 108, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ã‚·ãƒ³ãƒ—ãƒ«\nã‚«ãƒ©ãƒ¼:#4 ãƒ–ãƒ©ã‚¦ãƒ³(s)" },
      { row: 109, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ã‚·ãƒ³ãƒ—ãƒ«\nã‚«ãƒ©ãƒ¼:#4 ãƒ–ãƒ©ã‚¦ãƒ³(s)" },
      { row: 110, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ã‚·ãƒ³ãƒ—ãƒ«\nã‚«ãƒ©ãƒ¼:#5 ã‚°ãƒªãƒ¼ãƒ³" },
      { row: 111, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ã‚·ãƒ³ãƒ—ãƒ«\nã‚«ãƒ©ãƒ¼:#7 ãƒã‚¤ãƒ“ãƒ¼" },
      { row: 112, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ã‚·ãƒ³ãƒ—ãƒ«\nã‚«ãƒ©ãƒ¼:#8 ãƒ€ãƒ¼ã‚¯ãƒ–ãƒ©ã‚¦ãƒ³" },
      { row: 113, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ãƒãƒ³ãƒ‰ä»˜\nã‚«ãƒ©ãƒ¼:#1 ãƒ”ãƒ³ã‚¯" },
      { row: 114, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ãƒãƒ³ãƒ‰ä»˜\nã‚«ãƒ©ãƒ¼:#2 ãƒ©ã‚¤ãƒˆãƒ–ãƒ«ãƒ¼" },
      { row: 115, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ãƒãƒ³ãƒ‰ä»˜\nã‚«ãƒ©ãƒ¼:#3 ã‚°ãƒ¬ãƒ¼" },
      { row: 116, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ãƒãƒ³ãƒ‰ä»˜\nã‚«ãƒ©ãƒ¼:#4 ãƒ–ãƒ©ã‚¦ãƒ³(b)" },
      { row: 117, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ãƒãƒ³ãƒ‰ä»˜\nã‚«ãƒ©ãƒ¼:#5 ãƒ–ãƒ«ãƒ¼" },
      { row: 118, productId: "y009", sku: "ã‚¿ã‚¤ãƒ—:ãƒãƒ³ãƒ‰ä»˜\nã‚«ãƒ©ãƒ¼:#6 ãƒ–ãƒ©ãƒƒã‚¯" },

      // y009 åˆè¨ˆÃ—2 ç‰¹æ®Šè¡Œ (è¡Œ119)
      { row: 119, productId: "y009", sku: "ã‚«ãƒ¼ãƒ‰ã‚±ãƒ¼ã‚¹(=y009ã®è²©å£²å®Ÿç¸¾åˆè¨ˆ*2)", isSpecial: true, specialType: "multiplier", sourceProductId: "y009", multiplier: 2 },

      // y010 (è¡Œ120-122)
      { row: 120, productId: "y010", sku: "ã‚«ãƒ©ãƒ¼:ã‚¤ã‚¨ãƒ­ãƒ¼" },
      { row: 121, productId: "y010", sku: "ã‚«ãƒ©ãƒ¼:ã‚°ãƒ¬ãƒ¼" },
      { row: 122, productId: "y010", sku: "" },

      // y011golfball_case (è¡Œ123-126)
      { row: 123, productId: "y011golfball_case", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ©ã‚¦ãƒ³ï¼†ãƒã‚¤ãƒ“ãƒ¼" },
      { row: 124, productId: "y011golfball_case", sku: "ã‚«ãƒ©ãƒ¼:ã‚°ãƒªãƒ¼ãƒ³ï¼†ãƒ™ãƒ¼ã‚¸ãƒ¥" },
      { row: 125, productId: "y011golfball_case", sku: "ã‚«ãƒ©ãƒ¼:ã‚°ãƒ¬ãƒ¼ï¼†ãƒ”ãƒ³ã‚¯" },

      // y011golfball_case åˆè¨ˆÃ—1 ç‰¹æ®Šè¡Œ (è¡Œ126)
      { row: 126, productId: "y011golfball_case", sku: "ãƒ™ãƒ«ãƒˆ(=y011golfball_caseã®è²©å£²å®Ÿç¸¾åˆè¨ˆ*1)", isSpecial: true, specialType: "multiplier", sourceProductId: "y011golfball_case", multiplier: 1 },

      // y012pet_bathmat (è¡Œ127-135)
      { row: 127, productId: "y012pet_bathmat", sku: "ã‚«ãƒ©ãƒ¼:ãƒ›ãƒ¯ã‚¤ãƒˆ\nã‚µã‚¤ã‚º:ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼" },
      { row: 128, productId: "y012pet_bathmat", sku: "ã‚«ãƒ©ãƒ¼:ãƒ›ãƒ¯ã‚¤ãƒˆ\nã‚µã‚¤ã‚º:ãƒ¯ã‚¤ãƒ‰" },
      { row: 129, productId: "y012pet_bathmat", sku: "ã‚«ãƒ©ãƒ¼:ãƒ›ãƒ¯ã‚¤ãƒˆ\nã‚µã‚¤ã‚º:ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¯ã‚¤ãƒ‰" },
      { row: 130, productId: "y012pet_bathmat", sku: "ã‚«ãƒ©ãƒ¼:ã‚°ãƒ¬ãƒ¼\nã‚µã‚¤ã‚º:ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼" },
      { row: 131, productId: "y012pet_bathmat", sku: "ã‚«ãƒ©ãƒ¼:ã‚°ãƒ¬ãƒ¼\nã‚µã‚¤ã‚º:ãƒ¯ã‚¤ãƒ‰" },
      { row: 132, productId: "y012pet_bathmat", sku: "ã‚«ãƒ©ãƒ¼:ã‚°ãƒ¬ãƒ¼\nã‚µã‚¤ã‚º:ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¯ã‚¤ãƒ‰" },
      { row: 133, productId: "y012pet_bathmat", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ«ãƒ¼\nã‚µã‚¤ã‚º:ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼" },
      { row: 134, productId: "y012pet_bathmat", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ«ãƒ¼\nã‚µã‚¤ã‚º:ãƒ¯ã‚¤ãƒ‰" },
      { row: 135, productId: "y012pet_bathmat", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ«ãƒ¼\nã‚µã‚¤ã‚º:ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¯ã‚¤ãƒ‰" },

      // y013suit_belt (è¡Œ136-142)
      { row: 136, productId: "y013suit_belt", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ©ãƒƒã‚¯" },
      { row: 137, productId: "y013suit_belt", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ«ãƒ¼" },
      { row: 138, productId: "y013suit_belt", sku: "ã‚«ãƒ©ãƒ¼:ã‚¤ã‚¨ãƒ­ãƒ¼" },
      { row: 139, productId: "y013suit_belt", sku: "ã‚«ãƒ©ãƒ¼:ãƒ¬ãƒƒãƒ‰" },
      { row: 140, productId: "y013suit_belt", sku: "ã‚«ãƒ©ãƒ¼:ã‚·ãƒ«ãƒãƒ¼" },
      { row: 141, productId: "y013suit_belt", sku: "ã‚«ãƒ©ãƒ¼:ã‚°ãƒªãƒ¼ãƒ³" },

      // y013suit_belt åˆè¨ˆÃ—1 ç‰¹æ®Šè¡Œ (è¡Œ142)
      { row: 142, productId: "y013suit_belt", sku: "æ‰‹è·ç‰©ãƒãƒ³ãƒ‰(=y013suit_beltã®è²©å£²å®Ÿç¸¾åˆè¨ˆ*1)", isSpecial: true, specialType: "multiplier", sourceProductId: "y013suit_belt", multiplier: 1 },

      // y014gara_eliza (è¡Œ143-168)
      { row: 143, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#1 æ°´ç‰ã‚¤ã‚¨ãƒ­ãƒ¼\nã‚µã‚¤ã‚º:S" },
      { row: 144, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#1 æ°´ç‰ã‚¤ã‚¨ãƒ­ãƒ¼\nã‚µã‚¤ã‚º:M" },
      { row: 145, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#1 æ°´ç‰ã‚¤ã‚¨ãƒ­ãƒ¼\nã‚µã‚¤ã‚º:L" },
      { row: 146, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#1 æ°´ç‰ã‚¤ã‚¨ãƒ­ãƒ¼\nã‚µã‚¤ã‚º:XL" },
      { row: 147, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#2 æ°´ç‰ãƒ”ãƒ³ã‚¯\nã‚µã‚¤ã‚º:S" },
      { row: 148, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#2 æ°´ç‰ãƒ”ãƒ³ã‚¯\nã‚µã‚¤ã‚º:M" },
      { row: 149, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#2 æ°´ç‰ãƒ”ãƒ³ã‚¯\nã‚µã‚¤ã‚º:L" },
      { row: 150, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#2 æ°´ç‰ãƒ”ãƒ³ã‚¯\nã‚µã‚¤ã‚º:XL" },
      { row: 151, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#3 èŠ±æŸ„ãƒ–ãƒ«ãƒ¼\nã‚µã‚¤ã‚º:S" },
      { row: 152, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#3 èŠ±æŸ„ãƒ–ãƒ«ãƒ¼\nã‚µã‚¤ã‚º:M" },
      { row: 153, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#3 èŠ±æŸ„ãƒ–ãƒ«ãƒ¼\nã‚µã‚¤ã‚º:L" },
      { row: 154, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#3 èŠ±æŸ„ãƒ–ãƒ«ãƒ¼\nã‚µã‚¤ã‚º:XL" },
      { row: 155, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#4 èŠ±æŸ„ãƒ”ãƒ³ã‚¯\nã‚µã‚¤ã‚º:S" },
      { row: 156, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#4 èŠ±æŸ„ãƒ”ãƒ³ã‚¯\nã‚µã‚¤ã‚º:M" },
      { row: 157, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#4 èŠ±æŸ„ãƒ”ãƒ³ã‚¯\nã‚µã‚¤ã‚º:L" },
      { row: 158, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#4 èŠ±æŸ„ãƒ”ãƒ³ã‚¯\nã‚µã‚¤ã‚º:XL" },
      { row: 159, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#5 ãƒ–ãƒ©ãƒƒã‚¯\nã‚µã‚¤ã‚º:S" },
      { row: 160, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#5 ãƒ–ãƒ©ãƒƒã‚¯\nã‚µã‚¤ã‚º:M" },
      { row: 161, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#5 ãƒ–ãƒ©ãƒƒã‚¯\nã‚µã‚¤ã‚º:L" },
      { row: 162, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#5 ãƒ–ãƒ©ãƒƒã‚¯\nã‚µã‚¤ã‚º:XL" },
      { row: 163, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#6 å®‡å®™\nã‚µã‚¤ã‚º:S" },
      { row: 164, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#6 å®‡å®™\nã‚µã‚¤ã‚º:M" },
      { row: 165, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#6 å®‡å®™\nã‚µã‚¤ã‚º:L" },
      { row: 166, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#7 æ˜Ÿåº§\nã‚µã‚¤ã‚º:S" },
      { row: 167, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#7 æ˜Ÿåº§\nã‚µã‚¤ã‚º:M" },
      { row: 168, productId: "y014gara_eliza", sku: "ã‚«ãƒ©ãƒ¼:#7 æ˜Ÿåº§\nã‚µã‚¤ã‚º:L" },

      // y015karasu_net (è¡Œ169-173)
      { row: 169, productId: "y015karasu_net", sku: "ã‚µã‚¤ã‚º:1.2mÃ—1.2m" },
      { row: 170, productId: "y015karasu_net", sku: "ã‚µã‚¤ã‚º:1.5mÃ—1.5m" },
      { row: 171, productId: "y015karasu_net", sku: "ã‚µã‚¤ã‚º:1.5mÃ—2.0m" },
      { row: 172, productId: "y015karasu_net", sku: "ã‚µã‚¤ã‚º:2.0mÃ—3.0m" },
      { row: 173, productId: "y015karasu_net", sku: "ã‚µã‚¤ã‚º:3.0mÃ—4.0m" },

      // y016ac_mirror (è¡Œ174-177)
      { row: 174, productId: "y016ac_mirror", sku: "ä¸¸è§’ (20Ã—20cm)" },
      { row: 175, productId: "y016ac_mirror", sku: "ä¸¸è§’ (30Ã—20cm)" },
      { row: 176, productId: "y016ac_mirror", sku: "ä¸¸è§’ (28Ã—28cm)" },
      { row: 177, productId: "y016ac_mirror", sku: "" },

      // y017futon (è¡Œ178-180)
      { row: 178, productId: "y017futon", sku: "ä¸­60*80" },
      { row: 179, productId: "y017futon", sku: "å¤§80*100" },
      { row: 180, productId: "y017futon", sku: "ç‰¹å¤§100*120" },

      // y018cartowel (è¡Œ181-183)
      { row: 181, productId: "y018cartowel", sku: "ä¸­40*60" },
      { row: 182, productId: "y018cartowel", sku: "å¤§60*90" },
      { row: 183, productId: "y018cartowel", sku: "ç‰¹å¤§160*60" },

      // y019pet_cleaner (è¡Œ184-186)
      { row: 184, productId: "y019pet_cleaner", sku: "" },
      { row: 185, productId: "y019pet_cleaner", sku: "" },
      { row: 186, productId: "y019pet_cleaner", sku: "" },

      // y020pet_belt (è¡Œ187-206)
      { row: 187, productId: "y020pet_belt", sku: "" },
      { row: 188, productId: "y020pet_belt", sku: "" },
      { row: 189, productId: "y020pet_belt", sku: "" },
      { row: 190, productId: "y020pet_belt", sku: "" },
      { row: 191, productId: "y020pet_belt", sku: "" },
      { row: 192, productId: "y020pet_belt", sku: "" },
      { row: 193, productId: "y020pet_belt", sku: "" },
      { row: 194, productId: "y020pet_belt", sku: "" },
      { row: 195, productId: "y020pet_belt", sku: "" },
      { row: 196, productId: "y020pet_belt", sku: "" },
      { row: 197, productId: "y020pet_belt", sku: "" },
      { row: 198, productId: "y020pet_belt", sku: "" },
      { row: 199, productId: "y020pet_belt", sku: "" },
      { row: 200, productId: "y020pet_belt", sku: "" },
      { row: 201, productId: "y020pet_belt", sku: "" },
      { row: 202, productId: "y020pet_belt", sku: "" },
      { row: 203, productId: "y020pet_belt", sku: "" },
      { row: 204, productId: "y020pet_belt", sku: "" },
      { row: 205, productId: "y020pet_belt", sku: "" },
      { row: 206, productId: "y020pet_belt", sku: "" },

      // y021fuku_cover (è¡Œ207-211)
      { row: 207, productId: "y021fuku_cover", sku: "ã‚¿ã‚¤ãƒ—:çª“ãªã—ã‚·ãƒ§ãƒ¼ãƒˆ" },
      { row: 208, productId: "y021fuku_cover", sku: "ã‚¿ã‚¤ãƒ—:çª“ãªã—ãƒ­ãƒ³ã‚°" },
      { row: 209, productId: "y021fuku_cover", sku: "ã‚¿ã‚¤ãƒ—:çª“ä»˜ãã‚·ãƒ§ãƒ¼ãƒˆ" },
      { row: 210, productId: "y021fuku_cover", sku: "ã‚¿ã‚¤ãƒ—:çª“ä»˜ããƒ­ãƒ³ã‚°" },
      { row: 211, productId: "y021fuku_cover", sku: "" },

      // y022laundry_bag (è¡Œ212-215)
      { row: 212, productId: "y022laundry_bag", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ©ãƒƒã‚¯" },
      { row: 213, productId: "y022laundry_bag", sku: "ã‚«ãƒ©ãƒ¼:ã‚°ãƒ¬ãƒ¼" },
      { row: 214, productId: "y022laundry_bag", sku: "" },
      { row: 215, productId: "y022laundry_bag", sku: "" },

      // y023dis_shorts (è¡Œ216-223)
      { row: 216, productId: "y023dis_shorts", sku: "å¤šè‰² M" },
      { row: 217, productId: "y023dis_shorts", sku: "å¤šè‰² L" },
      { row: 218, productId: "y023dis_shorts", sku: "å¤šè‰² XL" },
      { row: 219, productId: "y023dis_shorts", sku: "å¤šè‰² 2XL" },
      { row: 220, productId: "y023dis_shorts", sku: "é»’ M" },
      { row: 221, productId: "y023dis_shorts", sku: "é»’ L" },
      { row: 222, productId: "y023dis_shorts", sku: "é»’ XL" },
      { row: 223, productId: "y023dis_shorts", sku: "é»’ 2XL" },

      // y024cat_tume (è¡Œ224-254)
      { row: 224, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ã‚µãƒ³ãƒ—ãƒ«\nã‚»ãƒƒãƒˆ:ï¼–ç¨®" },
      { row: 225, productId: "y024cat_tume", sku: "ãƒ–ãƒ©ãƒƒã‚¯ 20Ã—30" },
      { row: 226, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ©ãƒƒã‚¯\nã‚»ãƒƒãƒˆ:30Ã—100cm" },
      { row: 227, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ©ãƒƒã‚¯\nã‚»ãƒƒãƒˆ:40Ã—100cm" },
      { row: 228, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ©ãƒƒã‚¯\nã‚»ãƒƒãƒˆ:60Ã—100cm" },
      { row: 229, productId: "y024cat_tume", sku: "ãƒ€ãƒ¼ã‚¯ã‚°ãƒ¬ãƒ¼ 20Ã—30" },
      { row: 230, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ€ãƒ¼ã‚¯ã‚°ãƒ¬ãƒ¼\nã‚»ãƒƒãƒˆ:30Ã—100cm" },
      { row: 231, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ€ãƒ¼ã‚¯ã‚°ãƒ¬ãƒ¼\nã‚»ãƒƒãƒˆ:40Ã—100cm" },
      { row: 232, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ€ãƒ¼ã‚¯ã‚°ãƒ¬ãƒ¼\nã‚»ãƒƒãƒˆ:60Ã—100cm" },
      { row: 233, productId: "y024cat_tume", sku: "ãƒ©ã‚¤ãƒˆã‚°ãƒ¬ãƒ¼ 20Ã—30" },
      { row: 234, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ©ã‚¤ãƒˆã‚°ãƒ¬ãƒ¼\nã‚»ãƒƒãƒˆ:30Ã—100cm" },
      { row: 235, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ©ã‚¤ãƒˆã‚°ãƒ¬ãƒ¼\nã‚»ãƒƒãƒˆ:40Ã—100cm" },
      { row: 236, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ©ã‚¤ãƒˆã‚°ãƒ¬ãƒ¼\nã‚»ãƒƒãƒˆ:60Ã—100cm" },
      { row: 237, productId: "y024cat_tume", sku: "ãƒ–ãƒ©ã‚¦ãƒ³ 20Ã—30" },
      { row: 238, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ©ã‚¦ãƒ³\nã‚»ãƒƒãƒˆ:30Ã—100cm" },
      { row: 239, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ©ã‚¦ãƒ³\nã‚»ãƒƒãƒˆ:40Ã—100cm" },
      { row: 240, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ©ã‚¦ãƒ³\nã‚»ãƒƒãƒˆ:60Ã—100cm" },
      { row: 241, productId: "y024cat_tume", sku: "ãƒ™ãƒ¼ã‚¸ãƒ¥ 20Ã—30" },
      { row: 242, productId: "y024cat_tume", sku: "ã‚»ãƒƒãƒˆ:30Ã—100cm\nã‚«ãƒ©ãƒ¼:ãƒ™ãƒ¼ã‚¸ãƒ¥" },
      { row: 243, productId: "y024cat_tume", sku: "ã‚»ãƒƒãƒˆ:40Ã—100cm\nã‚«ãƒ©ãƒ¼:ãƒ™ãƒ¼ã‚¸ãƒ¥" },
      { row: 244, productId: "y024cat_tume", sku: "ã‚»ãƒƒãƒˆ:60Ã—100cm\nã‚«ãƒ©ãƒ¼:ãƒ™ãƒ¼ã‚¸ãƒ¥" },
      { row: 245, productId: "y024cat_tume", sku: "ã‚ªãƒ•ãƒ›ãƒ¯ã‚¤ãƒˆ 20Ã—30" },
      { row: 246, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ã‚ªãƒ•ãƒ›ãƒ¯ã‚¤ãƒˆ\nã‚»ãƒƒãƒˆ:30Ã—100cm" },
      { row: 247, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ã‚ªãƒ•ãƒ›ãƒ¯ã‚¤ãƒˆ\nã‚»ãƒƒãƒˆ:40Ã—100cm" },
      { row: 248, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:ã‚ªãƒ•ãƒ›ãƒ¯ã‚¤ãƒˆ\nã‚»ãƒƒãƒˆ:60Ã—100cm" },
      { row: 249, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:é€æ˜ é™é›»æ°—\nã‚»ãƒƒãƒˆ:40cmÃ—10m" },
      { row: 250, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:é€æ˜ é™é›»æ°—\nã‚»ãƒƒãƒˆ:60cmÃ—10m" },
      { row: 251, productId: "y024cat_tume", sku: "ã‚«ãƒ©ãƒ¼:é€æ˜ ã‚·ãƒ¼ãƒ«\nã‚»ãƒƒãƒˆ:31.5cmÃ—4.1m" },
      { row: 252, productId: "y024cat_tume", sku: "" },

      // y024cat_tume åˆè¨ˆÃ—1 ç‰¹æ®Šè¡Œ (è¡Œ253)
      { row: 253, productId: "y024cat_tume", sku: "ä¸¡é¢ã‚·ãƒ¼ãƒ«(=y024cat_tumeã®è²©å£²å®Ÿç¸¾åˆè¨ˆ*1)", isSpecial: true, specialType: "multiplier", sourceProductId: "y024cat_tume", multiplier: 1 },

      // y025_silicon_toilet (è¡Œ254-259)
      { row: 254, productId: "y025_silicon_toilet", sku: "ãƒ›ãƒ¯ã‚¤ãƒˆS" },
      { row: 255, productId: "y025_silicon_toilet", sku: "ãƒ›ãƒ¯ã‚¤ãƒˆM" },
      { row: 256, productId: "y025_silicon_toilet", sku: "ã‚°ãƒ¬ãƒ¼S" },
      { row: 257, productId: "y025_silicon_toilet", sku: "ã‚°ãƒ¬ãƒ¼M" },
      { row: 258, productId: "y025_silicon_toilet", sku: "ãƒ©ã‚¤ãƒˆãƒ–ãƒ©ã‚¦ãƒ³S" },
      { row: 259, productId: "y025_silicon_toilet", sku: "ãƒ©ã‚¤ãƒˆãƒ–ãƒ©ã‚¦ãƒ³M" },

      // y026_nuigurumi (è¡Œ260-269)
      { row: 260, productId: "y026_nuigurumi", sku: "ã‚«ãƒ©ãƒ¼:ãƒ›ãƒ¯ã‚¤ãƒˆ\nã‚µã‚¤ã‚º:ï¼”æ®µ" },
      { row: 261, productId: "y026_nuigurumi", sku: "ã‚«ãƒ©ãƒ¼:ãƒ›ãƒ¯ã‚¤ãƒˆ\nã‚µã‚¤ã‚º:ï¼–æ®µ" },
      { row: 262, productId: "y026_nuigurumi", sku: "ã‚«ãƒ©ãƒ¼:ã‚°ãƒ¬ãƒ¼\nã‚µã‚¤ã‚º:ï¼”æ®µ" },
      { row: 263, productId: "y026_nuigurumi", sku: "ã‚«ãƒ©ãƒ¼:ã‚°ãƒ¬ãƒ¼\nã‚µã‚¤ã‚º:ï¼–æ®µ" },
      { row: 264, productId: "y026_nuigurumi", sku: "ã‚«ãƒ©ãƒ¼:ãƒ”ãƒ³ã‚¯\nã‚µã‚¤ã‚º:ï¼”æ®µ" },
      { row: 265, productId: "y026_nuigurumi", sku: "ã‚«ãƒ©ãƒ¼:ãƒ”ãƒ³ã‚¯\nã‚µã‚¤ã‚º:ï¼–æ®µ" },
      { row: 266, productId: "y026_nuigurumi", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ©ãƒƒã‚¯\nã‚µã‚¤ã‚º:ï¼”æ®µ" },
      { row: 267, productId: "y026_nuigurumi", sku: "ã‚«ãƒ©ãƒ¼:ãƒ–ãƒ©ãƒƒã‚¯\nã‚µã‚¤ã‚º:ï¼–æ®µ" },

      // y026_nuigurumi åˆè¨ˆÃ—1 ç‰¹æ®Šè¡Œ (è¡Œ268)
      { row: 268, productId: "y026_nuigurumi", sku: "æ´—æ¿¯ãƒãƒƒãƒˆ(=y026_nuigurumiã®è²©å£²å®Ÿç¸¾åˆè¨ˆ*1)", isSpecial: true, specialType: "multiplier", sourceProductId: "y026_nuigurumi", multiplier: 1 },

      // y026_nuigurumi åˆè¨ˆÃ—2 ç‰¹æ®Šè¡Œ (è¡Œ269)
      { row: 269, productId: "y026_nuigurumi", sku: "ãƒ•ãƒƒã‚¯(=y026_nuigurumiã®è²©å£²å®Ÿç¸¾åˆè¨ˆ*2)", isSpecial: true, specialType: "multiplier", sourceProductId: "y026_nuigurumi", multiplier: 2 },

      // y027_sube-tape (è¡Œ270-274 - ç©º)
      { row: 270, productId: "y027_sube-tape", sku: "" },
      { row: 271, productId: "y027_sube-tape", sku: "" },
      { row: 272, productId: "y027_sube-tape", sku: "" },
      { row: 273, productId: "y027_sube-tape", sku: "" },
      { row: 274, productId: "", sku: "" },
    ];

    // ==========================================
    // ã‚»ãƒƒãƒˆåˆ†è§£ãƒ«ãƒ¼ãƒ«
    // ==========================================

    // y017futonï¼ˆå¸ƒå›£åœ§ç¸®è¢‹ï¼‰
    // ã‚­ãƒ¼ã¯æ­£è¦åŒ–å¾Œã®å½¢å¼ï¼ˆã‚¹ãƒšãƒ¼ã‚¹é™¤å»ã€å…¨è§’åŠè§’çµ±ä¸€ï¼‰
    const futonRules = {
      "ã‚»ãƒƒãƒˆå†…å®¹:ä¸­Ã—2(60Ã—80cm)": { "ä¸­60*80": 2, "å¤§80*100": 0, "ç‰¹å¤§100*120": 0 },
      "ã‚»ãƒƒãƒˆå†…å®¹:ä¸­Ã—4(60Ã—80cm)": { "ä¸­60*80": 4, "å¤§80*100": 0, "ç‰¹å¤§100*120": 0 },
      "ã‚»ãƒƒãƒˆå†…å®¹:å¤§Ã—1(80Ã—100cm)": { "ä¸­60*80": 0, "å¤§80*100": 1, "ç‰¹å¤§100*120": 0 },
      "ã‚»ãƒƒãƒˆå†…å®¹:å¤§Ã—3(80Ã—100cm)": { "ä¸­60*80": 0, "å¤§80*100": 3, "ç‰¹å¤§100*120": 0 },
      "ã‚»ãƒƒãƒˆå†…å®¹:ç‰¹å¤§Ã—1(100Ã—120cm)": { "ä¸­60*80": 0, "å¤§80*100": 0, "ç‰¹å¤§100*120": 1 },
      "ã‚»ãƒƒãƒˆå†…å®¹:ç‰¹å¤§Ã—2(100Ã—120cm)": { "ä¸­60*80": 0, "å¤§80*100": 0, "ç‰¹å¤§100*120": 2 },
      "ã‚»ãƒƒãƒˆå†…å®¹:å¤§Ã—1+ç‰¹å¤§Ã—1": { "ä¸­60*80": 0, "å¤§80*100": 1, "ç‰¹å¤§100*120": 1 },
      "ã‚»ãƒƒãƒˆå†…å®¹:å¤§Ã—2+ç‰¹å¤§Ã—1": { "ä¸­60*80": 0, "å¤§80*100": 2, "ç‰¹å¤§100*120": 1 },
    };

    // y018cartowelï¼ˆã‚«ãƒ¼ã‚¿ã‚ªãƒ«ï¼‰
    // ã‚­ãƒ¼ã¯æ­£è¦åŒ–å¾Œã®å½¢å¼ï¼ˆã‚¹ãƒšãƒ¼ã‚¹ãƒ»å…¨è§’åŠè§’çµ±ä¸€ï¼‰
    const cartowelRules = {
      "ã‚»ãƒƒãƒˆ:ä¸­Ã—1(40Ã—60cm)": { "ä¸­40*60": 1, "å¤§60*90": 0, "ç‰¹å¤§160*60": 0 },
      "ã‚»ãƒƒãƒˆ:ä¸­Ã—2(40Ã—60cm)": { "ä¸­40*60": 2, "å¤§60*90": 0, "ç‰¹å¤§160*60": 0 },
      "ã‚»ãƒƒãƒˆ:ä¸­Ã—4(40Ã—60cm)": { "ä¸­40*60": 4, "å¤§60*90": 0, "ç‰¹å¤§160*60": 0 },
      "ã‚»ãƒƒãƒˆ:å¤§Ã—1(60Ã—90cm)": { "ä¸­40*60": 0, "å¤§60*90": 1, "ç‰¹å¤§160*60": 0 },
      "ã‚»ãƒƒãƒˆ:å¤§Ã—2(60Ã—90cm)": { "ä¸­40*60": 0, "å¤§60*90": 2, "ç‰¹å¤§160*60": 0 },
      "ã‚»ãƒƒãƒˆ:å¤§Ã—1+ä¸­Ã—2": { "ä¸­40*60": 2, "å¤§60*90": 1, "ç‰¹å¤§160*60": 0 },
      "ã‚»ãƒƒãƒˆ:ç‰¹å¤§Ã—1(160Ã—60cm)": { "ä¸­40*60": 0, "å¤§60*90": 0, "ç‰¹å¤§160*60": 1 },
      "ã‚»ãƒƒãƒˆ:ç‰¹å¤§Ã—1+ä¸­Ã—1": { "ä¸­40*60": 1, "å¤§60*90": 0, "ç‰¹å¤§160*60": 1 },
    };

    // ã‚»ãƒƒãƒˆåˆ†è§£ç”¨ã®æ­£è¦åŒ–é–¢æ•°ï¼ˆã‚¹ãƒšãƒ¼ã‚¹é™¤å»ã€å…¨è§’åŠè§’çµ±ä¸€ã€Ã—çµ±ä¸€ï¼‰
    function normalizeSetSku(sku) {
      if (!sku) return "";
      return normalizeNumber(sku)
        .replace(/\s+/g, '')  // ã‚¹ãƒšãƒ¼ã‚¹é™¤å»
        .replace(/[xX]/g, 'Ã—'); // x ã‚’ Ã— ã«çµ±ä¸€
    }

    // ==========================================
    // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
    // ==========================================

    // å…¨è§’æ•°å­—ã‚’åŠè§’ã«å¤‰æ›
    function normalizeNumber(str) {
      return str.replace(/[ï¼-ï¼™]/g, s => String.fromCharCode(s.charCodeAt(0) - 0xFEE0));
    }

    // SKUæ–‡å­—åˆ—ã®æ­£è¦åŒ–ï¼ˆæ”¹è¡Œã‚’ã‚¹ãƒšãƒ¼ã‚¹ã«ã€å…¨è§’ã‚’åŠè§’ã«ï¼‰
    function normalizeSku(sku) {
      if (!sku) return "";
      return normalizeNumber(sku.trim());
    }

    // SKUæ¯”è¼ƒç”¨ã®æ­£è¦åŒ–ï¼ˆæ”¹è¡Œã¨ã‚¹ãƒšãƒ¼ã‚¹ã®é•ã„ã‚’å¸åï¼‰
    function normalizeForCompare(sku) {
      if (!sku) return "";
      // æ”¹è¡Œã‚’ã‚¹ãƒšãƒ¼ã‚¹ã«å¤‰æ›ã—ã€é€£ç¶šã™ã‚‹ã‚¹ãƒšãƒ¼ã‚¹ã‚’1ã¤ã«
      return normalizeNumber(sku.replace(/\r?\n/g, ' ').replace(/\s+/g, ' ').trim());
    }

    // SKUå®Œå…¨ä¸€è‡´ãƒã‚§ãƒƒã‚¯ï¼ˆæ”¹è¡Œã®é•ã„ã‚’è€ƒæ…®ï¼‰
    function skuMatches(salesSku, masterSku) {
      if (!salesSku || !masterSku) return false;

      const normalizedSales = normalizeForCompare(salesSku);
      const normalizedMaster = normalizeForCompare(masterSku);

      return normalizedSales === normalizedMaster;
    }

    // è²©å£²å®Ÿç¸¾ã‹ã‚‰å€¤ã‚’æŠ½å‡º
    function extractValue(sku, prefix) {
      if (!sku) return null;
      const lines = sku.split(/\r?\n/);
      for (const line of lines) {
        if (line.startsWith(prefix)) {
          return line.substring(prefix.length).trim();
        }
      }
      return null;
    }

    // æ‹¬å¼§å‰ã®å€¤ã‚’å–å¾—ï¼ˆã‚µã‚¤ã‚ºç”¨ï¼‰
    function extractSizeBeforeParen(value) {
      if (!value) return null;
      const match = value.match(/^([^ï¼ˆ(]+)/);
      return match ? normalizeNumber(match[1].trim()) : normalizeNumber(value.trim());
    }

    // æšæ•°ã‚’æŠ½å‡ºï¼ˆ10æšã€60æšã€100æšãªã©ï¼‰
    function extractSheetCount(sku) {
      if (!sku) return 0;
      const normalized = normalizeNumber(sku);
      const match = normalized.match(/(\d+)æš/);
      return match ? parseInt(match[1], 10) : 0;
    }

    // y024cat_tumeã®20Ã—30ã‚»ãƒƒãƒˆæšæ•°ã‚’æŠ½å‡ºï¼ˆ2æš or 4æšï¼‰
    function extractCatTumeSheets(sku) {
      if (!sku) return 0;
      const normalized = normalizeNumber(sku);
      // ã‚»ãƒƒãƒˆ:2æš(20Ã—30) or ã‚»ãƒƒãƒˆ:4æš(20Ã—30)
      const match = normalized.match(/ã‚»ãƒƒãƒˆ:(\d+)æš.*20[Ã—x]30/i);
      return match ? parseInt(match[1], 10) : 0;
    }

    // CSVã‚’ãƒ‘ãƒ¼ã‚¹ï¼ˆæ”¹è¡Œã‚’å«ã‚€ã‚»ãƒ«å¯¾å¿œï¼‰
    function parseCSV(text) {
      const rows = [];
      let currentRow = [];
      let currentCell = "";
      let inQuotes = false;

      for (let i = 0; i < text.length; i++) {
        const char = text[i];
        const nextChar = text[i + 1];

        if (inQuotes) {
          if (char === '"') {
            if (nextChar === '"') {
              currentCell += '"';
              i++;
            } else {
              inQuotes = false;
            }
          } else {
            currentCell += char;
          }
        } else {
          if (char === '"') {
            inQuotes = true;
          } else if (char === ',') {
            currentRow.push(currentCell);
            currentCell = "";
          } else if (char === '\r') {
            // skip
          } else if (char === '\n') {
            currentRow.push(currentCell);
            if (currentRow.length > 0) {
              rows.push(currentRow);
            }
            currentRow = [];
            currentCell = "";
          } else {
            currentCell += char;
          }
        }
      }

      // æœ€å¾Œã®ã‚»ãƒ«ã¨è¡Œã‚’è¿½åŠ 
      if (currentCell || currentRow.length > 0) {
        currentRow.push(currentCell);
        rows.push(currentRow);
      }

      return rows;
    }

    // æ–‡å­—ã‚³ãƒ¼ãƒ‰è‡ªå‹•åˆ¤åˆ¥ã—ã¦ãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›
    async function readFileAsText(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          const buffer = e.target.result;
          const uint8Array = new Uint8Array(buffer);

          // UTF-8 BOMãƒã‚§ãƒƒã‚¯
          if (uint8Array[0] === 0xEF && uint8Array[1] === 0xBB && uint8Array[2] === 0xBF) {
            const decoder = new TextDecoder('utf-8');
            resolve(decoder.decode(uint8Array.slice(3)));
            return;
          }

          // UTF-8ã¨ã—ã¦è©¦è¡Œ
          try {
            const decoder = new TextDecoder('utf-8', { fatal: true });
            const text = decoder.decode(uint8Array);
            resolve(text);
            return;
          } catch (e) {
            // Shift-JISã¨ã—ã¦è©¦è¡Œ
          }

          // Shift-JIS
          const decoder = new TextDecoder('shift-jis');
          resolve(decoder.decode(uint8Array));
        };
        reader.onerror = reject;
        reader.readAsArrayBuffer(file);
      });
    }

    // ==========================================
    // ãƒ¡ã‚¤ãƒ³å‡¦ç†
    // ==========================================

    let salesData = [];
    let resultData = [];
    let unmatchedData = [];

    // çµæœã‚’æ ¼ç´ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆãƒã‚¹ã‚¿ãƒ¼è¡Œç•ªå· -> æ•°é‡ï¼‰
    let quantities = {};

    // å•†å“åˆ¥åˆè¨ˆã‚’æ ¼ç´ï¼ˆåˆè¨ˆÃ—å€ç‡ãƒ«ãƒ¼ãƒ«ç”¨ï¼‰
    let productTotals = {};

    // ç©ºè¡Œå•†å“IDï¼ˆç„¡è¦–å¯¾è±¡ï¼‰
    const emptySkuProducts = new Set();
    masterData.forEach(m => {
      if (m.sku === "" && m.productId) {
        emptySkuProducts.add(m.productId);
      }
    });

    // ãƒã‚¹ã‚¿ãƒ¼æ¤œç´¢ï¼ˆå•†å“ID + SKUï¼‰
    function findMasterRow(productId, sku) {
      for (const m of masterData) {
        if (m.productId === productId && !m.isSpecial && m.sku && skuMatches(sku, m.sku)) {
          return m;
        }
      }
      return null;
    }

    // y025_silicon_toiletç”¨ã®ãƒã‚¹ã‚¿ãƒ¼æ¤œç´¢
    function findToiletMasterRow(colorSize) {
      for (const m of masterData) {
        if (m.productId === "y025_silicon_toilet" && m.sku === colorSize) {
          return m;
        }
      }
      return null;
    }

    // y023dis_shortsç”¨ã®ãƒã‚¹ã‚¿ãƒ¼æ¤œç´¢
    function findShortsMasterRow(colorSize) {
      // 2XLã®å…¨è§’/åŠè§’å¯¾å¿œ
      const normalized = normalizeNumber(colorSize);
      for (const m of masterData) {
        if (m.productId === "y023dis_shorts") {
          const masterNormalized = normalizeNumber(m.sku);
          if (normalized === masterNormalized) {
            return m;
          }
        }
      }
      return null;
    }

    // y024cat_tumeã®20Ã—30ç”¨ãƒã‚¹ã‚¿ãƒ¼æ¤œç´¢
    function findCatTume20x30MasterRow(color) {
      const targetSku = color + " 20Ã—30";
      for (const m of masterData) {
        if (m.productId === "y024cat_tume" && m.sku === targetSku) {
          return m;
        }
      }
      return null;
    }

    // y017futonç”¨ã®ãƒã‚¹ã‚¿ãƒ¼æ¤œç´¢
    function findFutonMasterRow(sku) {
      for (const m of masterData) {
        if (m.productId === "y017futon" && m.sku === sku) {
          return m;
        }
      }
      return null;
    }

    // y018cartowelç”¨ã®ãƒã‚¹ã‚¿ãƒ¼æ¤œç´¢
    function findCartowelMasterRow(sku) {
      for (const m of masterData) {
        if (m.productId === "y018cartowel" && m.sku === sku) {
          return m;
        }
      }
      return null;
    }

    // y008waki_padç”¨ã®ãƒã‚¹ã‚¿ãƒ¼æ¤œç´¢
    function findWakiPadMasterRow() {
      for (const m of masterData) {
        if (m.productId === "y008waki_pad" && m.sku === "10") {
          return m;
        }
      }
      return null;
    }

    // é›†è¨ˆå®Ÿè¡Œ
    function processData() {
      quantities = {};
      productTotals = {};
      unmatchedData = [];
      let matchCount = 0;

      // 1. å…¨å•†å“ã®è²©å£²åˆè¨ˆã‚’è¨ˆç®—ï¼ˆé€šå¸¸å•†å“ã®ã¿ã€ç‰¹æ®Šãƒ«ãƒ¼ãƒ«é©ç”¨å‰ï¼‰
      for (const sale of salesData) {
        const pid = sale.productId;
        if (!productTotals[pid]) {
          productTotals[pid] = 0;
        }
        productTotals[pid] += sale.quantity;
      }

      // 2. å„è²©å£²ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†
      for (const sale of salesData) {
        const { productId, productName, sku, quantity } = sale;

        // ç©ºè¡Œå•†å“ã¯ç„¡è¦–
        if (emptySkuProducts.has(productId)) {
          // ãƒã‚¹ã‚¿ãƒ¼ã«æœ‰åŠ¹ãªSKUãŒã‚ã‚‹ã‹ç¢ºèª
          const hasValidSku = masterData.some(m => m.productId === productId && m.sku && !m.isSpecial);
          if (!hasValidSku) {
            continue; // ç„¡è¦–ï¼ˆæœªå‡¦ç†ã«ã‚‚è¡¨ç¤ºã—ãªã„ï¼‰
          }
        }

        let processed = false;

        // ===== ç‰¹æ®Šãƒ«ãƒ¼ãƒ«å‡¦ç† =====

        // y008waki_pad: æšæ•°Ã·10
        if (productId === "y008waki_pad") {
          const sheets = extractSheetCount(sku);
          if (sheets > 0) {
            const value = (sheets / 10) * quantity;
            const masterRow = findWakiPadMasterRow();
            if (masterRow) {
              quantities[masterRow.row] = (quantities[masterRow.row] || 0) + value;
              matchCount++;
              processed = true;
            }
          }
        }

        // y017futon: ã‚»ãƒƒãƒˆåˆ†è§£
        else if (productId === "y017futon") {
          const normalizedSku = normalizeSetSku(sku);
          const rule = futonRules[normalizedSku];
          if (rule) {
            for (const [size, count] of Object.entries(rule)) {
              if (count > 0) {
                const masterRow = findFutonMasterRow(size);
                if (masterRow) {
                  quantities[masterRow.row] = (quantities[masterRow.row] || 0) + (count * quantity);
                }
              }
            }
            matchCount++;
            processed = true;
          }
        }

        // y018cartowel: ã‚»ãƒƒãƒˆåˆ†è§£
        else if (productId === "y018cartowel") {
          const normalizedSku = normalizeSetSku(sku);
          const rule = cartowelRules[normalizedSku];
          if (rule) {
            for (const [size, count] of Object.entries(rule)) {
              if (count > 0) {
                const masterRow = findCartowelMasterRow(size);
                if (masterRow) {
                  quantities[masterRow.row] = (quantities[masterRow.row] || 0) + (count * quantity);
                }
              }
            }
            matchCount++;
            processed = true;
          }
        }

        // y023dis_shorts: æšæ•°æ›ç®—Ã·5
        else if (productId === "y023dis_shorts") {
          const color = extractValue(sku, "ã‚«ãƒ©ãƒ¼:");
          const sizeRaw = extractValue(sku, "ã‚µã‚¤ã‚º:");
          const size = extractSizeBeforeParen(sizeRaw);
          const sheets = extractSheetCount(sku);

          if (color && size && sheets > 0) {
            const actualSheets = quantity * sheets;
            const packs = actualSheets / 5;
            const colorSize = color + " " + size;
            const masterRow = findShortsMasterRow(colorSize);
            if (masterRow) {
              quantities[masterRow.row] = (quantities[masterRow.row] || 0) + packs;
              matchCount++;
              processed = true;
            }
          }
        }

        // y024cat_tume: 20Ã—30ã®æšæ•°æ›ç®—
        else if (productId === "y024cat_tume") {
          const sheets = extractCatTumeSheets(sku);
          if (sheets > 0) {
            // 20Ã—30ã®2æš/4æšã‚»ãƒƒãƒˆ
            const color = extractValue(sku, "ã‚«ãƒ©ãƒ¼:");
            if (color) {
              const actualSheets = quantity * sheets;
              const masterRow = findCatTume20x30MasterRow(color);
              if (masterRow) {
                quantities[masterRow.row] = (quantities[masterRow.row] || 0) + actualSheets;
                matchCount++;
                processed = true;
              }
            }
          }

          // é€šå¸¸ç…§åˆã‚‚è©¦è¡Œï¼ˆ20Ã—30ä»¥å¤–ï¼‰
          if (!processed) {
            const masterRow = findMasterRow(productId, sku);
            if (masterRow) {
              quantities[masterRow.row] = (quantities[masterRow.row] || 0) + quantity;
              matchCount++;
              processed = true;
            }
          }
        }

        // y025_silicon_toilet: ã‚¿ã‚¤ãƒ—ç„¡è¦–ã€ã‚«ãƒ©ãƒ¼Ã—ã‚µã‚¤ã‚ºã§åˆç®—
        else if (productId === "y025_silicon_toilet") {
          const color = extractValue(sku, "ã‚«ãƒ©ãƒ¼:");
          const size = extractValue(sku, "ã‚µã‚¤ã‚º:");
          if (color && size) {
            const colorSize = color + size;
            const masterRow = findToiletMasterRow(colorSize);
            if (masterRow) {
              quantities[masterRow.row] = (quantities[masterRow.row] || 0) + quantity;
              matchCount++;
              processed = true;
            }
          }
        }

        // ===== é€šå¸¸ç…§åˆ =====
        if (!processed) {
          const masterRow = findMasterRow(productId, sku);
          if (masterRow) {
            quantities[masterRow.row] = (quantities[masterRow.row] || 0) + quantity;
            matchCount++;
            processed = true;
          }
        }

        // ãƒãƒƒãƒã—ãªã‹ã£ãŸå ´åˆã¯æœªå‡¦ç†ã«è¿½åŠ 
        if (!processed) {
          // ç©ºè¡Œå•†å“ã§ãƒã‚¹ã‚¿ãƒ¼ã«æœ‰åŠ¹ãªSKUãŒãªã„å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
          const hasValidSku = masterData.some(m => m.productId === productId && m.sku && !m.isSpecial);
          if (hasValidSku || !emptySkuProducts.has(productId)) {
            unmatchedData.push({
              productId,
              productName,
              sku,
              quantity,
              reason: "ãƒã‚¹ã‚¿ãƒ¼ã«è©²å½“ãªã—"
            });
          }
        }
      }

      // 3. åˆè¨ˆÃ—å€ç‡ãƒ«ãƒ¼ãƒ«ã®é©ç”¨
      for (const m of masterData) {
        if (m.isSpecial && m.specialType === "multiplier") {
          const total = productTotals[m.sourceProductId] || 0;
          quantities[m.row] = total * m.multiplier;
        }
      }

      // 4. çµæœãƒ‡ãƒ¼ã‚¿ä½œæˆï¼ˆãƒã‚¹ã‚¿ãƒ¼é †ï¼‰
      resultData = masterData.map(m => ({
        row: m.row,
        productId: m.productId,
        sku: m.sku,
        quantity: quantities[m.row] || 0
      }));

      return {
        total: salesData.length,
        matched: matchCount,
        unmatched: unmatchedData.length
      };
    }

    // CSVå‡ºåŠ›ï¼ˆUTF-8 BOMä»˜ãï¼‰
    function generateCSV() {
      let csv = "å•†å“ç®¡ç†ç•ªå·,ã™ã¹ã¦ã®æƒ…å ±,æ•°é‡\n";

      for (const row of resultData) {
        const productId = row.productId || "";
        // æ”¹è¡Œã‚’å«ã‚€å ´åˆã¯ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã§å›²ã‚€
        let sku = row.sku || "";
        if (sku.includes("\n") || sku.includes(",") || sku.includes('"')) {
          sku = '"' + sku.replace(/"/g, '""') + '"';
        }
        csv += `${productId},${sku},${row.quantity}\n`;
      }

      // UTF-8 BOM
      const bom = new Uint8Array([0xEF, 0xBB, 0xBF]);
      const blob = new Blob([bom, csv], { type: "text/csv;charset=utf-8" });
      return blob;
    }

    // ==========================================
    // UIå‡¦ç†
    // ==========================================

    const uploadArea = document.getElementById("uploadArea");
    const fileInput = document.getElementById("fileInput");
    const fileInfo = document.getElementById("fileInfo");
    const executeBtn = document.getElementById("executeBtn");
    const results = document.getElementById("results");
    const downloadBtn = document.getElementById("downloadBtn");

    // ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—
    uploadArea.addEventListener("dragover", (e) => {
      e.preventDefault();
      uploadArea.classList.add("dragover");
    });

    uploadArea.addEventListener("dragleave", () => {
      uploadArea.classList.remove("dragover");
    });

    uploadArea.addEventListener("drop", async (e) => {
      e.preventDefault();
      uploadArea.classList.remove("dragover");
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        await handleFile(files[0]);
      }
    });

    uploadArea.addEventListener("click", () => {
      fileInput.click();
    });

    fileInput.addEventListener("change", async (e) => {
      if (e.target.files.length > 0) {
        await handleFile(e.target.files[0]);
      }
    });

    async function handleFile(file) {
      if (!file.name.endsWith(".csv")) {
        alert("CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚");
        return;
      }

      try {
        const text = await readFileAsText(file);
        const rows = parseCSV(text);

        // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—
        const header = rows[0];
        const dataRows = rows.slice(1);

        salesData = dataRows
          .filter(row => row.length >= 4 && row[0])
          .map(row => ({
            productId: row[0].trim(),
            productName: row[1] ? row[1].trim() : "",
            sku: row[2] ? row[2].trim() : "",
            quantity: parseInt(row[3], 10) || 0
          }));

        fileInfo.textContent = `ãƒ•ã‚¡ã‚¤ãƒ«: ${file.name} (èª­ã¿è¾¼ã¿æ¸ˆã¿: ${salesData.length}è¡Œ)`;
        fileInfo.classList.add("show");
        executeBtn.disabled = false;
        results.classList.remove("show");

      } catch (error) {
        console.error(error);
        alert("ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
      }
    }

    // é›†è¨ˆå®Ÿè¡Œ
    executeBtn.addEventListener("click", () => {
      if (salesData.length === 0) {
        alert("è²©å£²å®Ÿç¸¾ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„ã€‚");
        return;
      }

      const stats = processData();

      document.getElementById("totalCount").textContent = stats.total;
      document.getElementById("matchCount").textContent = stats.matched;
      document.getElementById("unmatchCount").textContent = stats.unmatched;

      // æœªå‡¦ç†ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
      const tbody = document.getElementById("unmatchBody");
      const noData = document.getElementById("noUnmatchData");
      tbody.innerHTML = "";

      if (unmatchedData.length > 0) {
        noData.style.display = "none";
        for (const item of unmatchedData) {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${escapeHtml(item.productId)}</td>
            <td>${escapeHtml(item.productName)}</td>
            <td>${escapeHtml(item.sku)}</td>
            <td>${item.quantity}</td>
            <td>${escapeHtml(item.reason)}</td>
          `;
          tbody.appendChild(tr);
        }
      } else {
        noData.style.display = "block";
      }

      results.classList.add("show");
    });

    function escapeHtml(text) {
      const div = document.createElement("div");
      div.textContent = text;
      return div.innerHTML;
    }

    // CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
    downloadBtn.addEventListener("click", () => {
      const blob = generateCSV();
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      const now = new Date();
      const dateStr = now.getFullYear() +
        String(now.getMonth() + 1).padStart(2, "0") +
        String(now.getDate()).padStart(2, "0");
      a.download = `é›†è¨ˆçµæœ_${dateStr}.csv`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>
