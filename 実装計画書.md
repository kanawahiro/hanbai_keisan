在庫管理ツール 実装計画書（完全版）
1. プロジェクト概要
1-1. ツール名
販売実績集計ツール

1-2. 目的
日次の販売実績CSVを読み込み、マスターデータと照合して、マスターの並び順に沿った数量を出力するWebツール

1-3. 技術仕様
項目	内容
形式	HTMLファイル1つ（単体で動作）
動作環境	ブラウザ（Chrome推奨）
ライブラリ	SheetJS（Excel出力用）※任意
データ保存	なし（都度処理）
2. 入力データ仕様
2-1. 販売実績CSV
列構成：

列	列名	内容
A	商品管理番号	商品ID（y001, y002など）
B	商品名	商品の名前
C	すべての情報	SKU情報（色・サイズ等）※改行含む場合あり
D	数量	販売数
サンプル：

商品管理番号,商品名,すべての情報,数量
y001,エリザベスカラー 猫 犬 ソフト ネコ ,"タイプ:通常品
カラー:ピンク",1
y002,洗える ペットシーツ 犬 トイレマット ,シルバーパープル M,2
注意点：

「すべての情報」に改行が含まれる場合がある
文字コード：UTF-8またはShift-JIS対応
2-2. マスターデータ（ツール内部に組み込み）
列構成：

列	内容
商品管理番号	商品ID
すべての情報	SKU情報
マスターデータ（JSON形式で組み込み）：

Copyconst masterData = [
  { row: 1, productId: "y001", sku: "タイプ:通常品\nカラー:イエロー" },
  { row: 2, productId: "y001", sku: "タイプ:通常品\nカラー:グリーン" },
  { row: 3, productId: "y001", sku: "タイプ:通常品\nカラー:グレー" },
  { row: 4, productId: "y001", sku: "タイプ:通常品\nカラー:ピンク" },
  { row: 5, productId: "y001", sku: "タイプ:通常品\nカラー:ブルー" },
  { row: 6, productId: "y002", sku: "グレー XS" },
  { row: 7, productId: "y002", sku: "グレー S" },
  { row: 8, productId: "y002", sku: "グレー M" },
  // ... 以下、全マスターデータを記載
];
3. 出力仕様
3-1. メイン出力（CSV）
形式： UTF-8 BOM付きCSV（文字化け対策）

列構成：

商品管理番号	すべての情報	数量
出力例：

商品管理番号,すべての情報,数量
y001,タイプ:通常品 カラー:イエロー,1
y001,タイプ:通常品 カラー:グリーン,2
y001,タイプ:通常品 カラー:グレー,3
y001,タイプ:通常品 カラー:ピンク,1
y001,タイプ:通常品 カラー:ブルー,5
y002,グレー XS,0
y002,グレー S,9
3-2. 未処理データ一覧（Web画面表示）
マスターに該当がなく処理されなかったデータを表示

商品管理番号	商品名	すべての情報	数量	理由
y002	洗える ペットシーツ...	S（サービス品）	0	マスターに該当なし
4. 処理ロジック
4-1. 基本処理フロー
① 販売実績CSVを読み込み
② 各行をパース（商品管理番号、すべての情報、数量）
③ 商品管理番号ごとに処理を分岐
④ 通常商品：マスターと照合して数量を記録
⑤ 特殊商品：計算ルールを適用
⑥ マスターの並び順で結果を出力
⑦ 未処理データを一覧表示
4-2. 照合ルール
通常の照合：

「商品管理番号」と「すべての情報」の両方が一致した場合にマッチ
「すべての情報」内の改行は正規化して比較（改行→スペースまたは改行のまま両方試行）
5. 特殊計算ルール
5-1. ルール種別一覧
種別	対象商品	説明
A	合計×倍率	商品の販売合計に倍率をかけて特定行に記録
B	セット分解	セット商品を個別サイズに分解
C	枚数換算	枚数セットを計算して合算
D	枚数換算÷5	実枚数を計算後、5で割る
E	単純集計（抽出）	SKU情報から特定項目を抽出して集計
5-2. ルールA：合計×倍率
対象行と計算式：

マスター行	商品管理番号	SKU	計算式
120	y009	（該当SKU）	y009の販売合計 × 2
127	y011golfball_case	（該当SKU）	y011golfball_caseの販売合計 × 1
143	y013suit_belt	（該当SKU）	y013suit_beltの販売合計 × 1
254	y024cat_tume	（該当SKU）	y024cat_tumeの販売合計 × 1
269	y026_nuigurumi	（該当SKU）	y026_nuigurumiの販売合計 × 1
270	y026_nuigurumi	（該当SKU）	y026_nuigurumiの販売合計 × 2
実装ロジック：

Copy// 商品管理番号ごとの販売合計を計算
const productTotals = {};
salesData.forEach(row => {
  const id = row.productId;
  productTotals[id] = (productTotals[id] || 0) + row.quantity;
});

// 特定行に倍率をかけて記録
const multiplierRules = [
  { row: 120, sourceProductId: "y009", multiplier: 2 },
  { row: 127, sourceProductId: "y011golfball_case", multiplier: 1 },
  { row: 143, sourceProductId: "y013suit_belt", multiplier: 1 },
  { row: 254, sourceProductId: "y024cat_tume", multiplier: 1 },
  { row: 269, sourceProductId: "y026_nuigurumi", multiplier: 1 },
  { row: 270, sourceProductId: "y026_nuigurumi", multiplier: 2 },
];

multiplierRules.forEach(rule => {
  const total = productTotals[rule.sourceProductId] || 0;
  masterData[rule.row].quantity = total * rule.multiplier;
});
5-3. ルールB：セット分解
y017futon（布団圧縮袋）
販売実績の形式：

セット内容:中×2 (60×80cm)
セット内容:大×1+特大×1
マスター：

行	SKU
179	中60*80
180	大80*100
181	特大100*120
分解テーブル：

販売実績の「すべての情報」	中60*80	大80*100	特大100*120
セット内容:中×2 (60×80cm)	×2	0	0
セット内容:中×4 (60×80cm)	×4	0	0
セット内容:大×1 (80×100cm)	0	×1	0
セット内容:大×3 (80×100cm)	0	×3	0
セット内容:特大×1 (100×120cm)	0	0	×1
セット内容:特大×2 (100×120cm)	0	0	×2
セット内容:大×1+特大×1	0	×1	×1
セット内容:大×2+特大×1	0	×2	×1
実装ロジック：

Copyconst futonRules = {
  "セット内容:中×2 (60×80cm)": { "中60*80": 2, "大80*100": 0, "特大100*120": 0 },
  "セット内容:中×4 (60×80cm)": { "中60*80": 4, "大80*100": 0, "特大100*120": 0 },
  "セット内容:大×1 (80×100cm)": { "中60*80": 0, "大80*100": 1, "特大100*120": 0 },
  "セット内容:大×3 (80×100cm)": { "中60*80": 0, "大80*100": 3, "特大100*120": 0 },
  "セット内容:特大×1 (100×120cm)": { "中60*80": 0, "大80*100": 0, "特大100*120": 1 },
  "セット内容:特大×2 (100×120cm)": { "中60*80": 0, "大80*100": 0, "特大100*120": 2 },
  "セット内容:大×1+特大×1": { "中60*80": 0, "大80*100": 1, "特大100*120": 1 },
  "セット内容:大×2+特大×1": { "中60*80": 0, "大80*100": 2, "特大100*120": 1 },
};
y018cartowel（カータオル）
販売実績の形式：

セット:中×1 (40×60cm)
セット:特大×1+中×1
マスター：

行	SKU
182	中40*60
183	大60*90
184	特大160*60
分解テーブル：

販売実績の「すべての情報」	中40*60	大60*90	特大160*60
セット:中×1 (40×60cm)	×1	0	0
セット:中×2 (40×60cm)	×2	0	0
セット:中×4 (40×60cm)	×4	0	0
セット:大×1 (60×90cm)	0	×1	0
セット:大×2 (60×90cm)	0	×2	0
セット:大×1+中×2	×2	×1	0
セット:特大×1 (160×60cm)	0	0	×1
セット:特大×1+中×1	×1	0	×1
5-4. ルールC：枚数換算（y024cat_tume）
対象： 20×30サイズの2枚/4枚セット

販売実績の形式：

カラー:ブラック
セット:2枚(20×30)
マスター：

商品管理番号	SKU
y024cat_tume	ブラック 20×30
y024cat_tume	ダークグレー 20×30
y024cat_tume	ライトグレー 20×30
y024cat_tume	ブラウン 20×30
y024cat_tume	ベージュ 20×30
y024cat_tume	オフホワイト 20×30
計算ルール：

実枚数 = 数量 × セット枚数（2または4）
各カラーの実枚数を合算してマスターに記録
実装ロジック：

Copy// 販売実績から抽出
// カラー: の後の値 → カラー名
// セット: の後の数字 → 枚数（2 or 4）

const catTumeData = {}; // { "ブラック": 0, "ダークグレー": 0, ... }

salesData.forEach(row => {
  if (row.productId === "y024cat_tume" && row.sku.includes("20×30")) {
    const color = extractColor(row.sku); // カラー:XXX から抽出
    const sheets = extractSheetCount(row.sku); // 2枚 or 4枚
    catTumeData[color] = (catTumeData[color] || 0) + (row.quantity * sheets);
  }
});

// マスターの該当行に記録
// 例: "ブラック 20×30" → catTumeData["ブラック"]
5-5. ルールD：枚数換算÷5（y023dis_shorts）
販売実績の形式：

カラー:多色
サイズ:L（45kg~55kg）
セット:10枚
マスター：

行	SKU
217	多色 M
218	多色 L
219	多色 XL
220	多色 2XL
221	黒 M
222	黒 L
223	黒 XL
224	黒 2XL
計算ルール：

① 実枚数 = 数量 × セット枚数（3/5/10/15枚）
② パック数 = 実枚数 ÷ 5（小数のまま）
③ パック数をマスターに記録
抽出ロジック：

Copy// カラー: の後の値 → 多色 or 黒
// サイズ: の後の値 → M/L/XL/2XL（括弧の前まで）
// セット: の後の数字 → 枚数

function processShorts(row) {
  const color = extractValue(row.sku, "カラー:"); // 多色 or 黒
  const size = extractSize(row.sku, "サイズ:"); // M, L, XL, 2XL
  const sheets = extractNumber(row.sku, "セット:"); // 3, 5, 10, 15
  
  const actualSheets = row.quantity * sheets;
  const packs = actualSheets / 5; // 小数のまま
  
  return { color, size, packs };
}
5-6. ルールE：単純集計（y025_silicon_toilet）
販売実績の形式：

カラー:グレー
サイズ:M
タイプ:メール便
マスター：

行	SKU
255	ホワイトS
256	ホワイトM
257	グレーS
258	グレーM
259	ライトブラウンS
260	ライトブラウンM
計算ルール：

タイプ（メール便/宅配便）は無視
カラー × サイズ で単純合算
実装ロジック：

Copyfunction processToilet(row) {
  const color = extractValue(row.sku, "カラー:"); // ホワイト/グレー/ライトブラウン
  const size = extractValue(row.sku, "サイズ:"); // S or M
  
  const masterSku = color + size; // 例: "グレーM"
  return { masterSku, quantity: row.quantity };
}
6. 画面仕様
6-1. 画面レイアウト
┌─────────────────────────────────────────────────────┐
│  販売実績集計ツール                                    │
├─────────────────────────────────────────────────────┤
│                                                     │
│  【販売実績CSVをアップロード】                          │
│  ┌───────────────────────────────────┐              │
│  │  ここにファイルをドラッグ＆ドロップ     │              │
│  │  または クリックして選択              │              │
│  └───────────────────────────────────┘              │
│                                                     │
│  ファイル: sales_20260114.csv (読み込み済み: 150行)     │
│                                                     │
│  ┌────────────┐                                     │
│  │  集計実行   │                                     │
│  └────────────┘                                     │
│                                                     │
├─────────────────────────────────────────────────────┤
│  【集計結果】                                         │
│                                                     │
│  処理件数: 145件 / マッチ: 140件 / 未処理: 5件          │
│                                                     │
│  ┌────────────────┐  ┌────────────────┐            │
│  │ CSVダウンロード  │  │ Excelダウンロード │            │
│  └────────────────┘  └────────────────┘            │
│                                                     │
├─────────────────────────────────────────────────────┤
│  【未処理データ一覧】                                   │
│  ┌─────────────────────────────────────────────┐    │
│  │ 商品管理番号 │ 商品名 │ すべての情報 │ 数量 │ 理由  │    │
│  ├─────────────────────────────────────────────┤    │
│  │ y002       │ 洗える...│ S（サービス品）│ 0  │ 該当なし│    │
│  │ ...        │ ...     │ ...          │ ...│ ...   │    │
│  └─────────────────────────────────────────────┘    │
│                                                     │
└─────────────────────────────────────────────────────┘
7. 実装手順
Step 1: HTML/CSS基本構造
ファイルアップロードエリア
集計実行ボタン
結果表示エリア
未処理データ表示エリア
ダウンロードボタン
Step 2: CSVパース機能
ファイル読み込み（UTF-8/Shift-JIS対応）
CSV行のパース（改行を含むセル対応）
データ構造への変換
Step 3: マスターデータ組み込み
マスターデータをJavaScript配列として定義
行番号、商品管理番号、SKU情報を保持
Step 4: 基本照合ロジック
商品管理番号 + SKU情報での照合
改行の正規化処理
マッチした場合に数量を記録
Step 5: 特殊ルール実装
ルールA: 合計×倍率
ルールB: セット分解（y017futon, y018cartowel）
ルールC: 枚数換算（y024cat_tume）
ルールD: 枚数換算÷5（y023dis_shorts）
ルールE: 単純集計（y025_silicon_toilet）
Step 6: 出力機能
CSV出力（UTF-8 BOM付き）
未処理データの画面表示
Step 7: テスト・調整
サンプルデータでの動作確認
エッジケースの処理確認
8. マスターデータ（完全版）
以下のマスターデータをツールに組み込んでください：

Copyconst masterData = [
  // y001: エリザベスカラー
  { row: 1, productId: "y001", sku: "タイプ:通常品\nカラー:イエロー" },
  { row: 2, productId: "y001", sku: "タイプ:通常品\nカラー:グリーン" },
  { row: 3, productId: "y001", sku: "タイプ:通常品\nカラー:グレー" },
  { row: 4, productId: "y001", sku: "タイプ:通常品\nカラー:ピンク" },
  { row: 5, productId: "y001", sku: "タイプ:通常品\nカラー:ブルー" },
  
  // y002: ペットシーツ
  { row: 6, productId: "y002", sku: "グレー XS" },
  { row: 7, productId: "y002", sku: "グレー S" },
  { row: 8, productId: "y002", sku: "グレー M" },
  { row: 9, productId: "y002", sku: "グレー L" },
  { row: 10, productId: "y002", sku: "グレー XL" },
  { row: 11, productId: "y002", sku: "グレー 大" },
  { row: 12, productId: "y002", sku: "グレー 特大" },
  { row: 13, productId: "y002", sku: "ベージュ XS" },
  { row: 14, productId: "y002", sku: "ベージュ S" },
  { row: 15, productId: "y002", sku: "ベージュ M" },
  { row: 16, productId: "y002", sku: "ベージュ L" },
  { row: 17, productId: "y002", sku: "ベージュ XL" },
  { row: 18, productId: "y002", sku: "ベージュ 大" },
  { row: 19, productId: "y002", sku: "ベージュ 特大" },
  { row: 20, productId: "y002", sku: "シルバーパープル XS" },
  { row: 21, productId: "y002", sku: "シルバーパープル S" },
  { row: 22, productId: "y002", sku: "シルバーパープル M" },
  { row: 23, productId: "y002", sku: "シルバーパープル L" },
  { row: 24, productId: "y002", sku: "シルバーパープル XL" },
  { row: 25, productId: "y002", sku: "シルバーパープル 大" },
  { row: 26, productId: "y002", sku: "シルバーパープル 特大" },
  { row: 27, productId: "y002", sku: "骨柄グレー XS" },
  { row: 28, productId: "y002", sku: "骨柄グレー S" },
  { row: 29, productId: "y002", sku: "骨柄グレー M" },
  { row: 30, productId: "y002", sku: "骨柄グレー L" },
  { row: 31, productId: "y002", sku: "骨柄グレー XL" },
  { row: 32, productId: "y002", sku: "骨柄グレー 大" },
  { row: 33, productId: "y002", sku: "骨柄グレー 特大" },
  { row: 34, productId: "y002", sku: "骨柄ホワイト XS" },
  { row: 35, productId: "y002", sku: "骨柄ホワイト S" },
  { row: 36, productId: "y002", sku: "骨柄ホワイト M" },
  { row: 37, productId: "y002", sku: "骨柄ホワイト L" },
  { row: 38, productId: "y002", sku: "骨柄ホワイト XL" },
  { row: 39, productId: "y002", sku: "骨柄ホワイト 大" },
  { row: 40, productId: "y002", sku: "骨柄ホワイト 特大" },
  { row: 41, productId: "y002", sku: "ホワイト XS" },
  { row: 42, productId: "y002", sku: "ホワイト S" },
  { row: 43, productId: "y002", sku: "ホワイト M" },
  { row: 44, productId: "y002", sku: "ホワイト L" },
  { row: 45, productId: "y002", sku: "ホワイト XL" },
  { row: 46, productId: "y002", sku: "ホワイト 大" },
  { row: 47, productId: "y002", sku: "ホワイト 特大" },
  { row: 48, productId: "y002", sku: "犬柄ブラウン XS" },
  { row: 49, productId: "y002", sku: "犬柄ブラウン S" },
  { row: 50, productId: "y002", sku: "犬柄ブラウン M" },
  { row: 51, productId: "y002", sku: "犬柄ブラウン L" },
  { row: 52, productId: "y002", sku: "犬柄ブラウン XL" },
  { row: 53, productId: "y002", sku: "犬柄ブラウン 大" },
  { row: 54, productId: "y002", sku: "犬柄ブラウン 特大" },
  
  // y006: 防水ポーチ
  { row: 55, productId: "y006", sku: "カラー:#1 ブラック" },
  { row: 56, productId: "y006", sku: "カラー:#2 チャコールグレー" },
  { row: 57, productId: "y006", sku: "カラー:#3グレー" },
  { row: 58, productId: "y006", sku: "カラー:#4ネイビー" },
  { row: 59, productId: "y006", sku: "カラー:#5 ブルー" },
  { row: 60, productId: "y006", sku: "カラー:#6 グレイッシュブルー" },
  { row: 61, productId: "y006", sku: "カラー:#7 ベビーブルー" },
  { row: 62, productId: "y006", sku: "カラー:#8 グレイッシュグリーン" },
  { row: 63, productId: "y006", sku: "カラー:#9シーグリーン" },
  { row: 64, productId: "y006", sku: "カラー:#10イエロー" },
  { row: 65, productId: "y006", sku: "カラー:#11 クロムオレンジ" },
  { row: 66, productId: "y006", sku: "カラー:#12パープル" },
  { row: 67, productId: "y006", sku: "カラー:#13 ラベンダー" },
  { row: 68, productId: "y006", sku: "カラー:#14ピンク" },
  
  // y009: パスポートケース
  { row: 69, productId: "y009", sku: "タイプ:シンプル\nカラー:#1 ホワイト" },
  { row: 70, productId: "y009", sku: "タイプ:シンプル\nカラー:#2 ブラック" },
  { row: 71, productId: "y009", sku: "タイプ:シンプル\nカラー:#3 レッド" },
  { row: 72, productId: "y009", sku: "タイプ:シンプル\nカラー:#4 ブラウン(s)" },
  { row: 73, productId: "y009", sku: "タイプ:シンプル\nカラー:#5 グリーン" },
  { row: 74, productId: "y009", sku: "タイプ:シンプル\nカラー:#7 ネイビー" },
  { row: 75, productId: "y009", sku: "タイプ:シンプル\nカラー:#8 ダークブラウン" },
  { row: 76, productId: "y009", sku: "タイプ:バンド付\nカラー:#1 ピンク" },
  { row: 77, productId: "y009", sku: "タイプ:バンド付\nカラー:#2 ライトブルー" },
  { row: 78, productId: "y009", sku: "タイプ:バンド付\nカラー:#3 グレー" },
  { row: 79, productId: "y009", sku: "タイプ:バンド付\nカラー:#4 ブラウン(b)" },
  { row: 80, productId: "y009", sku: "タイプ:バンド付\nカラー:#5 ブルー" },
  { row: 81, productId: "y009", sku: "タイプ:バンド付\nカラー:#6 ブラック" },
  
  // y010
  { row: 82, productId: "y010", sku: "カラー:イエロー" },
  { row: 83, productId: "y010", sku: "カラー:グレー" },
  
  // y011golfball_case
  { row: 84, productId: "y011golfball_case", sku: "カラー:ブラウン＆ネイビー" },
  { row: 85, productId: "y011golfball_case", sku: "カラー:グリーン＆ベージュ" },
  { row: 86, productId: "y011golfball_case", sku: "カラー:グレー＆ピンク" },
  
  // y012pet_bathmat
  { row: 87, productId: "y012pet_bathmat", sku: "カラー:ホワイト\nサイズ:レギュラー" },
  { row: 88, productId: "y012pet_bathmat", sku: "カラー:ホワイト\nサイズ:ワイド" },
  { row: 89, productId: "y012pet_bathmat", sku: "カラー:ホワイト\nサイズ:スーパーワイド" },
  { row: 90, productId: "y012pet_bathmat", sku: "カラー:グレー\nサイズ:レギュラー" },
  { row: 91, productId: "y012pet_bathmat", sku: "カラー:グレー\nサイズ:ワイド" },
  { row: 92, productId: "y012pet_bathmat", sku: "カラー:グレー\nサイズ:スーパーワイド" },
  { row: 93, productId: "y012pet_bathmat", sku: "カラー:ブルー\nサイズ:レギュラー" },
  { row: 94, productId: "y012pet_bathmat", sku: "カラー:ブルー\nサイズ:ワイド" },
  { row: 95, productId: "y012pet_bathmat", sku: "カラー:ブルー\nサイズ:スーパーワイド" },
  
  // y013suit_belt
  { row: 96, productId: "y013suit_belt", sku: "カラー:ブラック" },
  { row: 97, productId: "y013suit_belt", sku: "カラー:ブルー" },
  { row: 98, productId: "y013suit_belt", sku: "カラー:イエロー" },
  { row: 99, productId: "y013suit_belt", sku: "カラー:レッド" },
  { row: 100, productId: "y013suit_belt", sku: "カラー:シルバー" },
  { row: 101, productId: "y013suit_belt", sku: "カラー:グリーン" },
  
  // y014gara_eliza
  { row: 102, productId: "y014gara_eliza", sku: "カラー:#1 水玉イエロー\nサイズ:S" },
  { row: 103, productId: "y014gara_eliza", sku: "カラー:#1 水玉イエロー\nサイズ:M" },
  { row: 104, productId: "y014gara_eliza", sku: "カラー:#1 水玉イエロー\nサイズ:L" },
  { row: 105, productId: "y014gara_eliza", sku: "カラー:#1 水玉イエロー\nサイズ:XL" },
  { row: 106, productId: "y014gara_eliza", sku: "カラー:#2 水玉ピンク\nサイズ:S" },
  { row: 107, productId: "y014gara_eliza", sku: "カラー:#2 水玉ピンク\nサイズ:M" },
  { row: 108, productId: "y014gara_eliza", sku: "カラー:#2 水玉ピンク\nサイズ:L" },
  { row: 109, productId: "y014gara_eliza", sku: "カラー:#2 水玉ピンク\nサイズ:XL" },
  { row: 110, productId: "y014gara_eliza", sku: "カラー:#3 花柄ブルー\nサイズ:S" },
  { row: 111, productId: "y014gara_eliza", sku: "カラー:#3 花柄ブルー\nサイズ:M" },
  { row: 112, productId: "y014gara_eliza", sku: "カラー:#3 花柄ブルー\nサイズ:L" },
  { row: 113, productId: "y014gara_eliza", sku: "カラー:#3 花柄ブルー\nサイズ:XL" },
  { row: 114, productId: "y014gara_eliza", sku: "カラー:#4 花柄ピンク\nサイズ:S" },
  { row: 115, productId: "y014gara_eliza", sku: "カラー:#4 花柄ピンク\nサイズ:M" },
  { row: 116, productId: "y014gara_eliza", sku: "カラー:#4 花柄ピンク\nサイズ:L" },
  { row: 117, productId: "y014gara_eliza", sku: "カラー:#4 花柄ピンク\nサイズ:XL" },
  { row: 118, productId: "y014gara_eliza", sku: "カラー:#5 ブラック\nサイズ:S" },
  { row: 119, productId: "y014gara_eliza", sku: "カラー:#5 ブラック\nサイズ:M" },
  { row: 120, productId: "y014gara_eliza", sku: "カラー:#5 ブラック\nサイズ:L" },
  { row: 121, productId: "y014gara_eliza", sku: "カラー:#5 ブラック\nサイズ:XL" },
  { row: 122, productId: "y014gara_eliza", sku: "カラー:#6 宇宙\nサイズ:S" },
  { row: 123, productId: "y014gara_eliza", sku: "カラー:#6 宇宙\nサイズ:M" },
  { row: 124, productId: "y014gara_eliza", sku: "カラー:#6 宇宙\nサイズ:L" },
  { row: 125, productId: "y014gara_eliza", sku: "カラー:#7 星座\nサイズ:S" },
  { row: 126, productId: "y014gara_eliza", sku: "カラー:#7 星座\nサイズ:M" },
  { row: 127, productId: "y014gara_eliza", sku: "カラー:#7 星座\nサイズ:L" },
  
  // y015karasu_net
  { row: 128, productId: "y015karasu_net", sku: "サイズ:1.2m×1.2m" },
  { row: 129, productId: "y015karasu_net", sku: "サイズ:1.5m×1.5m" },
  { row: 130, productId: "y015karasu_net", sku: "サイズ:1.5m×2.0m" },
  { row: 131, productId: "y015karasu_net", sku: "サイズ:2.0m×3.0m" },
  { row: 132, productId: "y015karasu_net", sku: "サイズ:3.0m×4.0m" },
  
  // y016ac_mirror
  { row: 133, productId: "y016ac_mirror", sku: "丸角 (20×20cm)" },
  { row: 134, productId: "y016ac_mirror", sku: "丸角 (30×20cm)" },
  { row: 135, productId: "y016ac_mirror", sku: "丸角 (28×28cm)" },
  
  // y017futon
  { row: 136, productId: "y017futon", sku: "中60*80" },
  { row: 137, productId: "y017futon", sku: "大80*100" },
  { row: 138, productId: "y017futon", sku: "特大100*120" },
  
  // y018cartowel
  { row: 139, productId: "y018cartowel", sku: "中40*60" },
  { row: 140, productId: "y018cartowel", sku: "大60*90" },
  { row: 141, productId: "y018cartowel", sku: "特大160*60" },
  
  // y021fuku_cover
  { row: 142, productId: "y021fuku_cover", sku: "タイプ:窓なしショート" },
  { row: 143, productId: "y021fuku_cover", sku: "タイプ:窓なしロング" },
  { row: 144, productId: "y021fuku_cover", sku: "タイプ:窓付きショート" },
  { row: 145, productId: "y021fuku_cover", sku: "タイプ:窓付きロング" },
  
  // y022laundry_bag
  { row: 146, productId: "y022laundry_bag", sku: "カラー:ブラック" },
  { row: 147, productId: "y022laundry_bag", sku: "カラー:グレー" },
  
  // y023dis_shorts
  { row: 148, productId: "y023dis_shorts", sku: "多色 M" },
  { row: 149, productId: "y023dis_shorts", sku: "多色 L" },
  { row: 150, productId: "y023dis_shorts", sku: "多色 XL" },
  { row: 151, productId: "y023dis_shorts", sku: "多色 2XL" },
  { row: 152, productId: "y023dis_shorts", sku: "黒 M" },
  { row: 153, productId: "y023dis_shorts", sku: "黒 L" },
  { row: 154, productId: "y023dis_shorts", sku: "黒 XL" },
  { row: 155, productId: "y023dis_shorts", sku: "黒 2XL" },
  
  // y024cat_tume
  { row: 156, productId: "y024cat_tume", sku: "カラー:サンプル\nセット:６種" },
  { row: 157, productId: "y024cat_tume", sku: "ブラック 20×30" },
  { row: 158, productId: "y024cat_tume", sku: "カラー:ブラック\nセット:30×100cm" },
  { row: 159, productId: "y024cat_tume", sku: "カラー:ブラック\nセット:40×100cm" },
  { row: 160, productId: "y024cat_tume", sku: "カラー:ブラック\nセット:60×100cm" },
  { row: 161, productId: "y024cat_tume", sku: "ダークグレー 20×30" },
  { row: 162, productId: "y024cat_tume", sku: "カラー:ダークグレー\nセット:30×100cm" },
  { row: 163, productId: "y024cat_tume", sku: "カラー:ダークグレー\nセット:40×100cm" },
  { row: 164, productId: "y024cat_tume", sku: "カラー:ダークグレー\nセット:60×100cm" },
  { row: 165, productId: "y024cat_tume", sku: "ライトグレー 20×30" },
  { row: 166, productId: "y024cat_tume", sku: "カラー:ライトグレー\nセット:30×100cm" },
  { row: 167, productId: "y024cat_tume", sku: "カラー:ライトグレー\nセット:40×100cm" },
  { row: 168, productId: "y024cat_tume", sku: "カラー:ライトグレー\nセット:60×100cm" },
  { row: 169, productId: "y024cat_tume", sku: "ブラウン 20×30" },
  { row: 170, productId: "y024cat_tume", sku: "カラー:ブラウン\nセット:30×100cm" },
  { row: 171, productId: "y024cat_tume", sku: "カラー:ブラウン\nセット:40×100cm" },
  { row: 172, productId: "y024cat_tume", sku: "カラー:ブラウン\nセット:60×100cm" },
  { row: 173, productId: "y024cat_tume", sku: "ベージュ 20×30" },
  { row: 174, productId: "y024cat_tume", sku: "セット:30×100cm\nカラー:ベージュ" },
  { row: 175, productId: "y024cat_tume", sku: "セット:40×100cm\nカラー:ベージュ" },
  { row: 176, productId: "y024cat_tume", sku: "セット:60×100cm\nカラー:ベージュ" },
  { row: 177, productId: "y024cat_tume", sku: "オフホワイト 20×30" },
  { row: 178, productId: "y024cat_tume", sku: "カラー:オフホワイト\nセット:30×100cm" },
  { row: 179, productId: "y024cat_tume", sku: "カラー:オフホワイト\nセット:40×100cm" },
  { row: 180, productId: "y024cat_tume", sku: "カラー:オフホワイト\nセット:60×100cm" },
  
  // y025_silicon_toilet
  { row: 181, productId: "y025_silicon_toilet", sku: "ホワイトS" },
  { row: 182, productId: "y025_silicon_toilet", sku: "ホワイトM" },
  { row: 183, productId: "y025_silicon_toilet", sku: "グレーS" },
  { row: 184, productId: "y025_silicon_toilet", sku: "グレーM" },
  { row: 185, productId: "y025_silicon_toilet", sku: "ライトブラウンS" },
  { row: 186, productId: "y025_silicon_toilet", sku: "ライトブラウンM" },
  
  // y026_nuigurumi
  { row: 187, productId: "y026_nuigurumi", sku: "カラー:ホワイト\nサイズ:４段" },
  { row: 188, productId: "y026_nuigurumi", sku: "カラー:ホワイト\nサイズ:６段" },
  { row: 189, productId: "y026_nuigurumi", sku: "カラー:グレー\nサイズ:４段" },
  { row: 190, productId: "y026_nuigurumi", sku: "カラー:グレー\nサイズ:６段" },
  { row: 191, productId: "y026_nuigurumi", sku: "カラー:ピンク\nサイズ:４段" },
  { row: 192, productId: "y026_nuigurumi", sku: "カラー:ピンク\nサイズ:６段" },
  { row: 193, productId: "y026_nuigurumi", sku: "カラー:ブラック\nサイズ:４段" },
  { row: 194, productId: "y026_nuigurumi", sku: "カラー:ブラック\nサイズ:６段" },
];
※注意：上記のマスターデータは最初に共有されたExcelファイルを元に作成していますが、行番号は実際のマスターと異なる可能性があります。実装時に正確な行番号とSKU情報を確認してください。

9. 特殊ルール行番号（要確認）
以下の行番号は、ユーザーから提供された情報に基づいています。実装前に正確な行番号とSKU情報を確認してください：

ルール	マスター行	商品管理番号	SKU	計算式
合計×倍率	120	y009	？	y009合計×2
合計×倍率	127	y011golfball_case	？	合計×1
合計×倍率	143	y013suit_belt	？	合計×1
合計×倍率	254	y024cat_tume	？	合計×1
合計×倍率	269	y026_nuigurumi	？	合計×1
合計×倍率	270	y026_nuigurumi	？	合計×2
10. テストケース
10-1. 基本照合テスト
入力：

商品管理番号,商品名,すべての情報,数量
y001,エリザベスカラー,"タイプ:通常品
カラー:ピンク",3
期待出力：

マスター行4（y001 / タイプ:通常品 カラー:ピンク）に数量3が記録される
10-2. セット分解テスト（y017futon）
入力：

y017futon,布団圧縮袋,セット内容:大×1+特大×1,2
期待出力：

大80*100 → 2（2×1）
特大100*120 → 2（2×1）
10-3. 枚数換算÷5テスト（y023dis_shorts）
入力：

y023dis_shorts,使い捨てショーツ,"カラー:黒
サイズ:L（45kg~55kg）
セット:10枚",2
期待出力：

黒 L → 4（2×10÷5 = 4）
10-4. 未処理データテスト
入力：

y002,ペットシーツ,S（サービス品）,1
期待出力：

未処理データ一覧に表示される
理由：マスターに該当なし